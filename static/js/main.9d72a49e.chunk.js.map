{"version":3,"sources":["state/auth/authTypes.js","state/utils.js","state/auth/authReducer.js","state/fbase/fbaseTypes.js","state/fbase/fbaseReducer.js","state/search/searchTypes.js","state/search/searchReducer.js","state/user/userTypes.js","state/user/userReducer.js","state/playlist/playlistTypes.js","state/tracks/tracksTypes.js","state/playlist/playlistReducer.js","state/tracks/tracksReducer.js","state/rootReducer.js","state/auth/authSagas.js","api/firebaseConfig.js","api/firebaseAuth.js","state/fbase/fbaseSagas.js","api/spotifyUtil.js","api/spotifySearch.js","state/search/searchSagas.js","api/spotifyUser.js","state/user/userSagas.js","api/spotifyPlaylist.js","state/playlist/playlistSagas.js","state/tracks/tracksSagas.js","state/rootSaga.js","state/store.js","images/LOGO.svg","state/search/searchActions.js","images/BGimg.png","images/Icons/Search.svg","views/SearchView.js","images/Icons/Spotify_Icon.png","images/Icons/Inboxes fill.svg","images/Icons/Inboxes.png","views/SearchResultView.js","state/tracks/tracksActions.js","state/playlist/playlistActions.js","presenters/SearchPresenter.js","views/PlaylistView.js","views/LoadingView.js","presenters/PlaylistPresenter.js","views/TracksView.js","presenters/TracksPresenter.js","views/AuthorizedView.js","presenters/AuthorizedPresenter.js","state/user/userActions.js","state/fbase/fbaseActions.js","state/auth/authActions.js","presenters/LoginPresenter.js","api/spotifyAuth.js","images/Startpage.png","views/StartView.js","presenters/StartPresenter.js","App.js","reportWebVitals.js","index.js"],"names":["AUTH_INIT_TEST","AUTH_SPOTIFY","AUTH_SPOTIFY_ERROR","AUTH_SPOTIFY_SET_STATE","AUTH_SPOTIFY_LOGOUT","createAction","type","payload","createReducer","initialState","handlers","state","action","hasOwnProperty","status","spotify","token","expires_in","spotify_string","error","types","secondsUntilExpiration","localStorage","setItem","Date","now","toUTCString","removeItem","FBASE_INIT_COMPLETED","FBASE_SET_UID","FBASE_SIGN_OUT","FBASE_SIGN_OUT_SUCCESS","FBASE_SIGN_OUT_ERROR","app","auth","uid","SEARCH_INIT_TEST","SEARCH_GET","SEARCH_GET_ERROR","SEARCH_GET_SUCCESS","SEARCH_NEXT","SEARCH_PREV","SEARCH_TAB_VISBILITY","latestQuery","activePage","isExact","resultTypes","isTabVisible","visible","authTypes","USER_INIT","USER_GET","USER_GET_SUCCESS","USER_GET_ERROR","id","display_name","country","PLAYLIST_MOVE_UP_SONG","PLAYLIST_MOVE_DOWN_SONG","PLAYLIST_DELETE_FROM_LIST","PLAYLIST_GET","PLAYLIST_TRACK_GET","PLAYLIST_ADD_TO_LIST","PLAYLIST_MOVE_UP_SONG_SUCCESS","PLAYLIST_MOVE_UP_SONG_ERROR","PLAYLIST_MOVE_DOWN_SONG_SUCCESS","PLAYLIST_MOVE_DOWN_SONG_ERROR","PLAYLIST_DELETE_FROM_LIST_SUCCESS","PLAYLIST_DELETE_FROM_LIST_ERROR","PLAYLIST_GET_SUCCESS","PLAYLIST_GET_ERROR","PLAYLIST_TRACK_GET_SUCCESS","PLAYLIST_TRACK_GET_ERROR","PLAYLIST_TRACK_GET_ALL_DONE","PLAYLIST_SELECT","PLAYLIST_FETCH_PROGRESS","PLAYLIST_ADD_TO_LIST_SUCCESS","PLAYLIST_ADD_TO_LIST_ERROR","PLAYLIST_ADD_TO_TRACKS","DELETE_FROM_TRACKS","TRACKS_SAVE_LOCATIONS","TRACKS_DELETE_LOCATIONS","selectedList","playlists","trackIndex","featureMaps","playlistsFetched","tracksFetched","fetchProgress","Object","keys","length","playlistsObj","forEach","playlist","snapshot_id","name","owner","description","image","images","external_urls","collaborative","tracks","values","playlist_id","trackIds","map","track","album_image","CI","playlistobj","reorderedList","tmp","console","log","trackList","updatedList","slice","concat","playlistId","currentPercentage","tracksTypes","trackId","trackObj","album_name","album","artists","a","is_local","preview_url","uri","duration","duration_ms","stash","selectedTrack","trackLocations","previewPlayer","trackLocationsObj","updatedStash","includes","stashList","reduce","acc","index","combineReducers","fbase","search","user","lists","handleAuthInit","authRootSaga","take","all","takeLatest","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","handleSignIn","signInAnonymously","then","response","catch","handleSignOut","signOut","initializeFirebase","authenticateFirebase","logout","handleSetRef","persistToken","listenForToken","fbaseRootSaga","call","getApps","apps","initializeApp","config","getAuth","initializeAuth","persistence","browserSessionPersistence","popupRedirectResolver","undefined","put","handleInitialAuth","persistedUser","store","dispatch","onAuthStateChanged","unsubscribe","select","getUid","getDatabase","db","set","ref","endpoint","value","expires_at","getItem","tokenRef","onValue","snapshot","remainingSeconds","data","val","tokenExpiration","parse","getTime","fork","tokenListener","takeLeading","tasks","cancel","baseUrl","requestTypes","handleHttpResponse","json","ok","startObj","retry_after","headers","get","assign","statusText","Promise","reject","spotifyApiCall","method","bodyObj","content_type","finalEndpoint","startsWith","parameters","JSON","stringify","fetch","getSearchResults","searchQuery","searchTypes","pageInfo","baseEndpoint","typesListString","tot","i","arr","queryEndpoint","encodeURIComponent","getSearch","getNextPage","getPrevPage","searchRootSaga","getResultTypes","query","getNextPageURL","nextPage","getPrevPageURL","prevPage","fbaseTypes","next","previous","getCurrentUser","getUser","userRootSaga","fetchPlaylist","offset","fetchTrack","moveTrack","range_start","insert_before","deleteFromPlaylist","addToPlaylist","uris","handleMoveUp","handleMoveDown","handleDeleteFromPlaylist","handleFetchPlaylist","handleFetchTrack","watchTracksFetch","handleAddToPlaylist","playlistRootSaga","getToken","getSearchPage","track_uri","total","remainingPlaylists","allPlaylists","items","delay","userId","ownerPlaylists","filter","remainingTracks","allTracks","wt","wrappedTrack","buffer","buffers","expanding","actionChannel","trackFetchChannel","counter","isEmpty","getNumPlaylists","numPlaylists","Math","round","searchPage","t","takeEvery","tracksRootSaga","playlistChannel","rootSaga","window","__REDUX_DEVTOOLS_EXTENSION__","sagaMiddleware","createSagaMiddleware","createStore","rootReducer","applyMiddleware","run","actions","initSearch","getPreviousPage","setIsTabVisible","SearchView","props","className","alt","src","BGimg","Form","Group","controlId","Control","autoFocus","tabVisible","placeholder","onChange","e","onSearch","target","getSearchBarRef","searchicon","SearchResultView","defaultValue","Table","size","class","results","item","Card","href","spotifyUrl","artist","isFetchingPlaylists","disabled","onClick","notify","list","onAddToPlaylist","Button","variant","isInStash","onDeleteFromTracks","onAddToTracks","trackmarked","untrackmark","rel","spotifyicon","currentPage","aria-label","onPrevPage","aria-hidden","numPages","onNextPage","deleteFromList","addToTracks","deleteFromTracks","moveUpSong","moveDownSong","fetchPlaylists","selectPlaylist","toast","configure","mapDispatchToProps","searchActions","tracksActions","playlistActions","connect","totalResults","itemsArray","artistString","smallestAlbumImage","smallest","height","trackMinutes","floor","trackSeconds","url","previewSong","rawItems","useState","setSearch","searchBarRef","useRef","useEffect","current","focus","page","setPage","ceil","term","setNextPage","setPrevPage","success","PlaylistView","selectedPlaylist","onSelectPlaylist","LOGO","searchTerm","onSearchTerm","width","borderless","trackmarkicon","nottrackedicon","ButtonGroup","actionsDisabled","onMoveUpSong","onMoveDownSong","onDeleteSong","LoadingView","percentage","sizeClass","fetchTracks","selectedPlaylistData","playlistTracks","setSearchTerm","searchResults","setSearchResults","preSearchTracks","searcher","FuzzySearch","caseSensitive","TracksView","onDeleteTrack","tracksArray","stashTracks","AuthorizedView","Tab","Container","defaultActiveKey","Nav","Item","Link","eventKey","onTabClick","onSearchTabClick","NavDropdown","title","username","Navbar","Brand","Content","Pane","fetchSpotifyUser","initUser","fetchUser","initFbase","authFbase","setUid","setSearchTabVisibility","history","useHistory","push","initAuth","saveSpotifyToken","saveSpotifyTokenError","setSpotifyState","authActions","params","useParams","scope","d","authUrl","StartView","Startintro","loginUrl","spotifyString","setSpotifyString","randomString","len","Uint8Array","crypto","getRandomValues","Array","from","dec","toString","padStart","join","generateSpotifyString","spotifyAuthUrl","storedToken","sessionStorage","clear","path","component","LoginPresenter","exact","StartPresenter","AuthorizedPresenter","render","to","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","hashType","document","getElementById"],"mappings":"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","file":"static/js/main.9d72a49e.chunk.js","sourcesContent":["// src/state/auth/authTypes.js\r\nexport const AUTH_INIT_TEST = 'AUTH_INIT_TEST';\r\nexport const AUTH_SPOTIFY = 'AUTH_SPOTIFY';\r\nexport const AUTH_SPOTIFY_ERROR = 'AUTH_SPOTIFY_ERROR';\r\nexport const AUTH_SPOTIFY_SET_STATE = 'AUTH_SPOTIFY_SET_STATE';\r\nexport const AUTH_SPOTIFY_LOGOUT = 'AUTH_SPOTIFY_LOGOUT';","// redux/utils.js\r\n\r\nexport const createAction =\r\n    (type, payload = {}) => ({type, ...payload});\r\n\r\n// create reducer given its handlers and default/initial state\r\nexport const createReducer = (initialState, handlers) =>\r\n    // the reducer takes an action and the current state to update the state with the action\r\n    (state = initialState, action) => {\r\n        // there is a handler for the action type, call it\r\n        if(handlers.hasOwnProperty(action.type))\r\n            return handlers[action.type](state, action);\r\n        // there is no handler for the action type, leave state unchanged\r\n        else\r\n            return state;\r\n    }\r\n\r\n\r\nexport const createExpirationDate = (secondsUntilExpiration) => {\r\n    return new Date(Date.now() + secondsUntilExpiration*1000);\r\n}\r\n\r\nexport const isDateExpired = (expirationDate) => (expirationDate.getTime() < Date.now());\r\n\r\nexport const isDateExpiredIn = (expirationDate, remainingSeconds) => (expirationDate.getTime()+remainingSeconds*1000 < Date.now());","// src/state/auth/authReducer.js\r\nimport * as types from './authTypes';\r\nimport { createExpirationDate, createReducer } from '../utils';\r\n\r\nconst initialState = {\r\n    status: null,\r\n    spotify: {\r\n        token: null,\r\n        expires_in: 0,\r\n        spotify_string: null,\r\n        error: null\r\n    }\r\n}\r\n\r\nexport default createReducer(initialState, {\r\n    [types.AUTH_INIT_TEST]: (state, action) => {\r\n        return { ...state, status: \"OK\"};\r\n    },\r\n    [types.AUTH_SPOTIFY]: (state, action) => {\r\n        localStorage.setItem(\"spotifyToken\", action.token);\r\n        localStorage.setItem(\"spotifyExpiration\", createExpirationDate(3600-5).toUTCString()); // set expiration of token to 1 hour minus 5 seconds\r\n        return { ...state,\r\n            spotify: {\r\n                token: action.token,\r\n                expires_in: action.expires_in || state.spotify.expires_in,\r\n                spotify_string: state.spotify.spotify_string,\r\n                error: null\r\n            }\r\n        }\r\n    },\r\n    [types.AUTH_SPOTIFY_ERROR]: (state, action) => {\r\n        return { ...state,\r\n            spotify: {\r\n                token: null,\r\n                expires_in: null,\r\n                spotify_string: state.spotify.spotify_string,\r\n                error: action.error\r\n            }\r\n        }\r\n    },\r\n    [types.AUTH_SPOTIFY_SET_STATE]: (state, action) => {\r\n        localStorage.setItem(\"spotifyState\", action.spotify_string);\r\n        return { ...state,\r\n            spotify: {\r\n                ...state.spotify,\r\n                spotify_string: action.spotify_string\r\n            }\r\n        }\r\n    },\r\n    [types.AUTH_SPOTIFY_LOGOUT]: (state, action) => {\r\n        localStorage.removeItem(\"spotifyToken\");\r\n        localStorage.removeItem(\"spotifyExpiration\");\r\n        return {\r\n            ...initialState\r\n        }\r\n    }\r\n});","// src/state/fbase/fbaseTypes.js\r\nexport const FBASE_INIT = 'FBASE_INIT';\r\nexport const FBASE_INIT_COMPLETED = 'FBASE_INIT_COMPLETED';\r\nexport const FBASE_AUTHENTICATE = 'FBASE_AUTHENTICATE';\r\nexport const FBASE_SET_UID = 'FBASE_SET_UID';\r\nexport const FBASE_SIGN_OUT = 'FBASE_SIGN_OUT';\r\nexport const FBASE_SIGN_OUT_SUCCESS = 'FBASE_SIGN_OUT_SUCCESS';\r\nexport const FBASE_SIGN_OUT_ERROR = 'FBASE_SIGN_OUT_ERROR';\r\n","// src/state/fbase/fbaseReducer.js\r\nimport * as types from './fbaseTypes';\r\nimport { createReducer } from '../utils';\r\n\r\nconst initialState = {\r\n    status: null,\r\n    app: null,\r\n    auth: null,\r\n    uid: \"\",\r\n}\r\n\r\nexport default createReducer(initialState, {\r\n    [types.FBASE_INIT_COMPLETED]: (state, action) => {\r\n        return { ...state, status: \"OK\", app: action.payload.app, auth: action.payload.auth };\r\n    },\r\n    [types.FBASE_SET_UID]: (state, action) => {\r\n        return { ...state, uid: action.uid};\r\n    },\r\n    [types.FBASE_SIGN_OUT]: (state, action) => {\r\n        return { ...initialState };\r\n    },\r\n    [types.FBASE_SIGN_OUT_SUCCESS]: (state, action) => {\r\n        return { ...initialState };\r\n    },\r\n    [types.FBASE_SIGN_OUT_ERROR]: (state, action) => {\r\n        return { ...initialState, status: \"ERROR\"}\r\n    }\r\n});","// src/state/search/searchTypes.js\r\nexport const SEARCH_INIT_TEST = 'SEARCH_INIT_TEST';\r\nexport const SEARCH_GET = 'SEARCH_GET';\r\nexport const SEARCH_GET_ERROR = 'SEARCH_GET_ERROR';\r\nexport const SEARCH_GET_SUCCESS = 'SEARCH_GET_SUCCESS';\r\nexport const SEARCH_NEXT = 'SEARCH_NEXT'; \r\nexport const SEARCH_PREV = 'SEARCH_PREV';\r\nexport const SEARCH_TAB_VISBILITY = 'SEARCH_TAB_VISBILITY';\r\n","// src/state/search/searchReducer.js\r\nimport * as types from './searchTypes';\r\nimport * as authTypes from '../auth/authTypes';\r\nimport { createReducer } from '../utils';\r\n\r\nconst initialState = {\r\n    status: null,\r\n    latestQuery: null,\r\n    activePage: null,\r\n    isExact: false,\r\n    resultTypes: [\"track\"],\r\n    isTabVisible: false,\r\n}\r\n\r\nexport default createReducer(initialState, {\r\n    [types.SEARCH_INIT_TEST]: (state, action) => {\r\n        return { ...state, status: \"initialized\"};\r\n    },\r\n    [types.SEARCH_GET]: (state, action) => {\r\n        return { ...state, status: \"Query accepted\"}\r\n    },\r\n    [types.SEARCH_GET_SUCCESS]: (state, action) => {\r\n        return { ...state, activePage: action.payload, status: \"API OK\"}\r\n    },\r\n    [types.SEARCH_GET_ERROR]: (state, action) => {\r\n        return { ...state, activePage: initialState.activePage, status: \"API ERROR\"}\r\n    },\r\n    [types.SEARCH_NEXT]: (state, action) => {\r\n        return { ...state, status: \"Next Page Found\"}\r\n    },\r\n    [types.SEARCH_PREV]: (state, action) => {\r\n        return { ...state, status: \"Prev Page Found\"}\r\n    },\r\n    [types.SEARCH_TAB_VISBILITY]: (state, action) => {\r\n        return { ...state, isTabVisible: action.visible }\r\n    },\r\n    [authTypes.AUTH_SPOTIFY_LOGOUT]: (state, action) => {\r\n        return {...initialState};\r\n    },   \r\n});\r\n\r\n","// src/state/user/userTypes.js\r\nexport const USER_INIT = 'USER_INIT';\r\nexport const USER_GET = 'USER_GET';\r\nexport const USER_GET_SUCCESS = 'USER_GET_SUCCESS';\r\nexport const USER_GET_ERROR = 'USER_GET_ERROR';","// src/state/user/userReducer.js\r\nimport * as types from './userTypes';\r\nimport * as authTypes from '../auth/authTypes';\r\nimport { createReducer } from '../utils';\r\n\r\nconst initialState = {\r\n    status: null,\r\n    id: null,\r\n    display_name: null,\r\n    country: null,\r\n    error: null\r\n}\r\n\r\nexport default createReducer(initialState, {\r\n    [types.USER_INIT]: (state, action) => {\r\n        return { ...state, status: \"OK\"};\r\n    },\r\n    [types.USER_GET_SUCCESS]: (state, action) => {\r\n        return { ...state, ...action.payload, error: null, status: \"OK\"}\r\n    },\r\n    [types.USER_GET_ERROR]: (state, action) => {\r\n        return { ...state, error: action.payload, status: \"ERROR\"}\r\n    },\r\n    [authTypes.AUTH_SPOTIFY_LOGOUT]: (state, action) => initialState,\r\n    \r\n});","// src/state/playlist/playlistTypes.js\n\n//for saga\nexport const PLAYLIST_MOVE_UP_SONG = 'PLAYLIST_MOVE_UP_SONG';\nexport const PLAYLIST_MOVE_DOWN_SONG = 'PLAYLIST_MOVE_DOWN_SONG';\nexport const PLAYLIST_DELETE_FROM_LIST = 'PLAYLIST_DELETE_FROM_LIST';\nexport const PLAYLIST_GET = \"PLAYLIST_GET\";\nexport const PLAYLIST_TRACK_GET = \"PLAYLIST_TRACK_GET\";\nexport const PLAYLIST_ADD_TO_LIST = \"PLAYLIST_ADD_TO_LIST\";\n\n\n\n//for reducer\nexport const PLAYLIST_MOVE_UP_SONG_SUCCESS = 'PLAYLIST_MOVE_UP_SONG_SUCCESS';\nexport const PLAYLIST_MOVE_UP_SONG_ERROR = 'PLAYLIST_MOVE_UP_SONG_ERROR';\nexport const PLAYLIST_MOVE_DOWN_SONG_SUCCESS = 'PLAYLIST_MOVE_DOWN_SONG_SUCCESS';\nexport const PLAYLIST_MOVE_DOWN_SONG_ERROR = 'PLAYLIST_MOVE_DOWN_SONG_ERROR';\nexport const PLAYLIST_DELETE_FROM_LIST_SUCCESS = 'PLAYLIST_DELETE_FROM_LIST_SUCCESS';\nexport const PLAYLIST_DELETE_FROM_LIST_ERROR = 'PLAYLIST_DELETE_FROM_LIST_ERROR';\nexport const PLAYLIST_GET_SUCCESS = \"PLAYLIST_GET_SUCCESS\";\nexport const PLAYLIST_GET_ERROR = \"PLAYLIST_GET_ERROR\";\nexport const PLAYLIST_TRACK_GET_SUCCESS = \"PLAYLIST_TRACK_GET_SUCCESS\";\nexport const PLAYLIST_TRACK_GET_ERROR = \"PLAYLIST_TRACK_GET_ERROR\";\nexport const PLAYLIST_TRACK_GET_ALL_DONE = \"PLAYLIST_TRACK_GET_ALL_DONE\";\nexport const PLAYLIST_SELECT = \"PLAYLIST_SELECT\";\nexport const PLAYLIST_FETCH_PROGRESS = \"PLAYLIST_FETCH_PROGRESS\";\nexport const PLAYLIST_ADD_TO_LIST_SUCCESS = \"PLAYLIST_ADD_TO_LIST_SUCCESS\";\nexport const PLAYLIST_ADD_TO_LIST_ERROR = \"PLAYLIST_ADD_TO_LIST_ERROR\";\n\n","// src/state/tracks/tracksTypes.js\n//export const PLAYLIST_DELETE_FROM_LIST = 'PLAYLIST_DELETE_FROM_LIST';\nexport const PLAYLIST_ADD_TO_TRACKS = 'PLAYLIST_ADD_TO_TRACKS';\nexport const DELETE_FROM_TRACKS = 'DELETE_FROM_TRACKS';\nexport const TRACKS_SAVE_LOCATIONS = 'TRACKS_SAVE_LOCATION';\nexport const TRACKS_DELETE_LOCATIONS = 'TRACKS_DELETE_LOCATIONS';\n","// src/state/playlist/playlistReducer.js\r\nimport * as types from './playlistTypes';\r\nimport * as tracksTypes from '../tracks/tracksTypes';\r\nimport * as authTypes from '../auth/authTypes';\r\nimport { createReducer } from '../utils';\r\n\r\nconst initialState = {\r\n    //initial state\r\n    status: null,\r\n    error: null,\r\n    selectedList: \"\",\r\n    playlists: {},\r\n    trackIndex: {},\r\n    featureMaps: {},\r\n    playlistsFetched: false,\r\n    tracksFetched: false,\r\n    fetchProgress: null,\r\n\r\n\r\n    //mock data\r\n    // status: null,\r\n    // selectedList: \"\",\r\n    // playlists: {           \r\n    //     \"1234\" : {\r\n    //         tracks: [\"test1\",\"test2\",\"test3\",\"test4\",\"test5\"]\r\n    //     }\r\n    // },\r\n    // trackIndex: {},\r\n    // featureMaps: {},\r\n    // playlistsFetched: false\r\n\r\n}\r\n\r\nexport default createReducer(initialState, {\r\n    [types.PLAYLIST_GET_SUCCESS]: (state, action) => {\r\n        if(!action.payload.playlists || Object.keys(action.payload.playlists).length === 0){\r\n            // user has no playlists\r\n            return {...state, playlistsFetched: true};\r\n        }\r\n        let playlistsObj = {};\r\n        action.payload.playlists.forEach(playlist => {\r\n            playlistsObj[playlist.id] = {\r\n                snapshot_id: playlist.snapshot_id,\r\n                name: playlist.name,\r\n                id: playlist.id,\r\n                owner: playlist.owner.display_name || playlist.owner.id,\r\n                description: playlist.description,\r\n                image: (playlist.images.length >= 2 && playlist.images[1]) || null,\r\n                external_urls: playlist.external_urls,\r\n                collaborative: playlist.collaborative,\r\n                tracks: null,\r\n            };\r\n        });\r\n\r\n        return {...state,\r\n            playlists: playlistsObj,\r\n            playlistsFetched: true,\r\n            selectedList: Object.values(playlistsObj)[0].id,\r\n            status: \"Fetch Playlists Success\",\r\n        }\r\n    },\r\n    [types.PLAYLIST_GET_ERROR]: (state, action) => {\r\n        return {...state,\r\n            error: action.payload, \r\n            status: \"ERROR\"\r\n        }\r\n    },\r\n\r\n    [types.PLAYLIST_TRACK_GET_SUCCESS]: (state, action) => {\r\n        const playlist_id = action.payload.playlist_id;\r\n        let trackIds = action.payload.tracks.map(track => track.id);\r\n        let trackIndex = state.trackIndex;\r\n        let tracks = action.payload.tracks;\r\n        tracks.forEach( track => {\r\n            if(!trackIndex.hasOwnProperty(track.id)){\r\n                trackIndex[track.id]=track;\r\n            }\r\n\r\n        });\r\n\r\n        let playlist = state.playlists[playlist_id];\r\n        if(tracks && playlist.image === null){\r\n            playlist.image = (tracks.length >= 1 && tracks[0].album_image) ? action.payload.tracks[0].album_image : null;\r\n        }\r\n\r\n\r\n        return {...state,\r\n            playlists: {\r\n                ...state.playlists,\r\n                [playlist_id]:{\r\n                    ...state.playlists[playlist_id],\r\n                    tracks: trackIds\r\n                }\r\n                \r\n            },\r\n            trackIndex: {...trackIndex},\r\n        }\r\n    },\r\n    [types.PLAYLIST_TRACK_GET_ERROR]: (state, action) => {\r\n        return {...state,\r\n            error: action.payload, \r\n            status: \"ERROR\"\r\n        }\r\n    },\r\n    [types.PLAYLIST_TRACK_GET_ALL_DONE]: (state, action) => {\r\n        return { ...state, tracksFetched: true };\r\n    },\r\n\r\n    [types.PLAYLIST_MOVE_UP_SONG_SUCCESS]: (state, action) => {\r\n        //const playlistId = action.playlistId;\r\n        let snapshot_id = action.payload.snapshot_id;\r\n        const CI = action.payload.CI;\r\n        if(CI === 0){\r\n            return state;\r\n        }\r\n\r\n        let playlistobj = state.playlists[state.selectedList];\r\n        let reorderedList = playlistobj.tracks;\r\n\r\n        let tmp = reorderedList[CI-1];\r\n        reorderedList[CI-1] = reorderedList[CI];\r\n        reorderedList[CI] = tmp;\r\n\r\n        return { ...state, \r\n                playlists: {\r\n                    ...state.playlists,\r\n                    [state.selectedList]: {\r\n                        ...playlistobj,\r\n                        snapshot_id: snapshot_id,\r\n                        tracks: [...reorderedList]\r\n                    },\r\n\r\n            }\r\n        };\r\n    },\r\n    [types.PLAYLIST_MOVE_UP_SONG_ERROR]: (state, action) => {\r\n        return {...state,\r\n            error: action.payload, \r\n            status: \"ERROR\"\r\n        }\r\n    },\r\n\r\n    [types.PLAYLIST_MOVE_DOWN_SONG_SUCCESS]: (state, action) => {\r\n        let snapshot_id = action.payload.snapshot_id;\r\n        //const playlistId = action.playlistId;\r\n        const CI = action.payload.CI;\r\n\r\n        let playlistobj = state.playlists[state.selectedList];\r\n        if(CI === playlistobj.tracks.length - 1){\r\n            return state;\r\n        }\r\n        let reorderedList = playlistobj.tracks;\r\n\r\n        let tmp = reorderedList[CI];\r\n        reorderedList[CI] = reorderedList[CI+1];\r\n        reorderedList[CI+1] = tmp;\r\n\r\n        return { ...state, \r\n                playlists: {\r\n                    ...state.playlists,\r\n                    [state.selectedList]: {\r\n                        ...playlistobj,\r\n                        snapshot_id: snapshot_id,\r\n                        tracks: [...reorderedList]\r\n                    },\r\n\r\n            }\r\n        };\r\n    },\r\n    [types.PLAYLIST_MOVE_DOWN_SONG_ERROR]: (state, action) => {\r\n        return {...state,\r\n            error: action.payload, \r\n            status: \"ERROR\"\r\n        }\r\n    },\r\n\r\n    [types.PLAYLIST_DELETE_FROM_LIST_SUCCESS]: (state, action) => {\r\n        let snapshot_id = action.payload.snapshot_id;\r\n        const CI = action.payload.CI;\r\n        console.log(state.selectedList)\r\n        let playlistobj = state.playlists[state.selectedList];\r\n        let trackList = playlistobj.tracks;\r\n        let updatedList = trackList.slice(0, CI).concat(trackList.slice(CI+1, trackList.length));\r\n        \r\n\r\n        return { ...state, \r\n                        playlists: {\r\n                            ...state.playlists,\r\n                            [state.selectedList]: {\r\n                                ...playlistobj,\r\n                                snapshot_id: snapshot_id,\r\n                                tracks: updatedList\r\n                            },\r\n\r\n                    }\r\n                };\r\n    },\r\n    [types.PLAYLIST_DELETE_FROM_LIST_ERROR]: (state, action) => {\r\n        return {...state,\r\n            error: action.payload, \r\n            status: \"ERROR\"\r\n        }\r\n    },\r\n\r\n    [types.PLAYLIST_SELECT]: (state, action) => {\r\n        let playlistId = action.playlistId;\r\n\r\n        return {...state,\r\n            selectedList: playlistId,\r\n        }\r\n    },\r\n    [types.PLAYLIST_FETCH_PROGRESS]: (state, action) => {\r\n        return { ...state, fetchProgress: action.currentPercentage };\r\n    },\r\n    [tracksTypes.PLAYLIST_ADD_TO_TRACKS]: (state, action) => {\r\n        const trackId = action.trackId;\r\n        const track = action.track;\r\n        let trackIndex = state.trackIndex;\r\n        if(!trackIndex.hasOwnProperty(trackId) && track){\r\n            let trackObj = {\r\n                album_name: track.album.name,\r\n                album_image: (track.album.images.length >= 2 && track.album.images[1]) || null,\r\n                artists: track.artists.map(a=>a.name),\r\n                is_local: track.is_local,\r\n                external_urls: track.external_urls,\r\n                name: track.name,\r\n                id: track.id,\r\n                preview_url: track.preview_url,\r\n                uri: track.uri,\r\n                duration: track.duration_ms\r\n            };\r\n            trackIndex[trackId]=trackObj;\r\n        }\r\n        return {...state, trackIndex: {...trackIndex}};\r\n    },\r\n    [types.PLAYLIST_ADD_TO_LIST_SUCCESS]: (state, action) => {\r\n        let snapshot_id = action.payload.snapshot_id;\r\n        const playlist_id = action.payload.playlistId;\r\n        const trackId = action.payload.trackId;\r\n        let playlistobj = state.playlists[playlist_id];\r\n        let trackList = playlistobj.tracks;\r\n        let updatedList = [...trackList, trackId];\r\n\r\n        let trackObj = action.payload.trackObj;\r\n        let trackIndex = state.trackIndex;\r\n        if(trackObj){\r\n            let track = {\r\n                album_name: trackObj.album.name,\r\n                album_image: (trackObj.album.images.length >= 2 && trackObj.album.images[1]) || null,\r\n                artists: trackObj.artists.map(a=>a.name),\r\n                is_local: trackObj.is_local,\r\n                external_urls: trackObj.external_urls,\r\n                name: trackObj.name,\r\n                id: trackObj.id,\r\n                preview_url: trackObj.preview_url,\r\n                uri: trackObj.uri,\r\n                duration: trackObj.duration_ms\r\n            }\r\n            trackIndex[trackId]=track;\r\n        }\r\n\r\n\r\n        return { ...state, \r\n            playlists: {\r\n                ...state.playlists,\r\n                [playlist_id]: {\r\n                    ...playlistobj,\r\n                    snapshot_id: snapshot_id,\r\n                    tracks: updatedList\r\n                },\r\n            },\r\n            trackIndex: {...trackIndex},\r\n        };\r\n\r\n\r\n    },\r\n    [types.PLAYLIST_ADD_TO_LIST_ERROR]: (state, action) => {\r\n        return {...state,\r\n            error: action.payload, \r\n            status: \"ERROR\"\r\n        }\r\n    },\r\n    [authTypes.AUTH_SPOTIFY_LOGOUT]: (state, action) => {\r\n        return {...initialState, trackIndex: {}};\r\n    }\r\n})\r\n","import * as types from './tracksTypes';\nimport * as authTypes from '../auth/authTypes';\nimport { createReducer } from '../utils';\n\nconst initialState = {\n    status: null,\n    stash: [],\n    selectedTrack: \"\",\n    trackLocations: {},\n    previewPlayer: {},\n\n    //mock data\n    // status: null,\n    // stash: [\"s1\",\"s2\"],\n    // selectedTrack: \"s1\",\n    // trackLocations: {\n    //     \"s1\": {\n    //         \"p1\": true,\n    //         \"p2\": true\n    //     },\n    //     \"s2\": {\n    //         \"p1\": true\n    //     }\n    // },\n    // previewPlayer: {},\n}\n\nexport default createReducer(initialState, {\n    [types.TRACKS_DELETE_LOCATIONS]: (state, action) => {\n        const playlistId = action.payload.playlistId;\n        const trackId = action.payload.trackId;\n        let trackLocationsObj = state.trackLocations[trackId];\n\n        return {...state,\n            trackLocations: {\n                ...state.trackLocations,\n                [trackId]:{\n                    ...trackLocationsObj,\n                    [playlistId]: false\n                }\n            }\n        }\n    },\n    [types.PLAYLIST_ADD_TO_TRACKS]: (state, action) => {\n        const trackId = action.trackId;\n        let updatedStash = state.stash;\n        if(!state.stash.includes(trackId)){\n            updatedStash = [...state.stash, trackId];\n        }\n\n        return {...state,\n            stash: updatedStash\n        }\n    },\n    [types.DELETE_FROM_TRACKS]: (state, action) => {\n        let CI = action.CI;\n        const trackId = action.trackId;\n        const stashList = state.stash;\n        if(trackId){\n            // cancel deletion if track is not in stash\n            if(!stashList.includes(trackId)) return { ...state };\n            stashList.reduce((acc,id,index) => {\n                if(id===trackId){\n                    CI = index;\n                }\n            });\n        }\n        let updatedStash = stashList.slice(0, CI).concat(stashList.slice(CI+1, stashList.length));\n\n        return {...state,\n            stash: updatedStash\n        }\n    },\n    [types.TRACKS_SAVE_LOCATIONS]: (state, action) => {\n        const playlist_id = action.payload.playlist_id;\n        let trackIds = action.payload.trackIds;\n        let trackLocations = state.trackLocations;\n        trackIds.forEach((trackId) => {\n            if(!trackLocations.hasOwnProperty(trackId)){\n                trackLocations[trackId] = {};\n            }\n            if(!trackLocations[trackId][playlist_id]){\n                trackLocations[trackId][playlist_id] = true;\n            }\n        });\n        return {\n            ...state,\n            trackLocations: {\n                ...trackLocations\n            }\n        };\n    },\n    [authTypes.AUTH_SPOTIFY_LOGOUT]: (state, action) => {\n        return {...initialState, trackLocations: {}};\n    }\n})","// src/state/rootReducer.js\r\nimport { combineReducers } from \"redux\";\r\nimport auth from \"./auth/authReducer\";\r\nimport fbase from './fbase/fbaseReducer';\r\nimport search from './search/searchReducer';\r\nimport user from './user/userReducer';\r\nimport lists from './playlist/playlistReducer';\r\nimport tracks from './tracks/tracksReducer';\r\n\r\n\r\n// TODO: import different reducers\r\n\r\n// TODO: add imported reducers in object\r\nexport default combineReducers(\r\n    { auth, fbase, search, user, lists, tracks}\r\n);","// src/state/auth/authSagas.js\r\nimport { all, take, takeLatest } from 'redux-saga/effects';\r\nimport * as types from './authTypes';\r\n\r\nfunction* handleAuthInit(){\r\n    while(true){\r\n        yield take(types.AUTH_INIT_TEST);\r\n    }\r\n}\r\n\r\nfunction* authRootSaga() {\r\n    yield all([\r\n        takeLatest(types.AUTH_INIT_TEST, handleAuthInit)\r\n    ])\r\n};\r\n\r\nexport default authRootSaga;","// src/api/firebaseConfig.js\r\n// Your web app's Firebase configuration\r\nvar firebaseConfig = {\r\n    apiKey: \"AIzaSyD8zs9oK-BvtUICviOHLrVpcNOzbMvUR_k\",\r\n    authDomain: \"listify-project-56d94.firebaseapp.com\",\r\n    databaseURL: \"https://listify-project-56d94-default-rtdb.europe-west1.firebasedatabase.app\",\r\n    projectId: \"listify-project-56d94\",\r\n    storageBucket: \"listify-project-56d94.appspot.com\",\r\n    messagingSenderId: \"108020178071\",\r\n    appId: \"1:108020178071:web:b81127db0ed946e8abddd2\"\r\n};\r\nexport default firebaseConfig;\r\n  ","// src/api/firebaseAuth.js\r\nimport { signInAnonymously, signOut } from 'firebase/auth';\r\n\r\nfunction handleSignIn(auth) {\r\n    return signInAnonymously(auth)\r\n        .then(response => (response))\r\n        .catch(error => (error));\r\n}\r\nfunction handleSignOut(auth) {\r\n    return signOut(auth)\r\n        .then(response => ({response}))\r\n        .catch(error => ({error}));\r\n}\r\n\r\nexport { handleSignIn, handleSignOut };","// src/state/fbase/fbaseSagas.js\r\nimport { all, call, cancel, fork, put, takeLeading, take, select } from 'redux-saga/effects';\r\nimport store from '../store';\r\nimport * as types from './fbaseTypes';\r\nimport * as authTypes from '../auth/authTypes';\r\nimport { getApps, initializeApp } from 'firebase/app';\r\nimport config from '../../api/firebaseConfig';\r\nimport { initializeAuth, browserSessionPersistence, getAuth, onAuthStateChanged } from 'firebase/auth';\r\nimport { getDatabase, onValue, ref, set } from 'firebase/database';\r\nimport { handleSignIn, handleSignOut } from '../../api/firebaseAuth';\r\nimport { isDateExpiredIn } from '../utils';\r\n\r\nfunction* initializeFirebase(){\r\n    let apps = yield call(getApps);\r\n    let app = (apps.length > 0) ? apps[0] : null;\r\n    if(!app){\r\n        app = yield call(initializeApp, config);\r\n    }\r\n    let auth = yield call(getAuth);\r\n    if(!auth){\r\n        auth = yield call(initializeAuth, app, {persistence: browserSessionPersistence,\r\n            popupRedirectResolver: undefined,\r\n        });\r\n    }\r\n    yield put({'type': types.FBASE_INIT_COMPLETED, payload: {app, auth} });\r\n}\r\n\r\nfunction* authenticateFirebase(){\r\n    const auth = yield call(getAuth);\r\n    const handleInitialAuth = (persistedUser) =>{\r\n        if(persistedUser){\r\n            store.dispatch({'type': types.FBASE_SET_UID, uid: persistedUser.uid});\r\n        }else{\r\n            handleSignIn(auth).then(response => {\r\n                store.dispatch({'type': types.FBASE_SET_UID, uid: response.user.uid})\r\n            }).catch(error => console.error(error));\r\n        }\r\n    };\r\n    const unsubscribe = yield call(onAuthStateChanged, auth, handleInitialAuth);\r\n    unsubscribe();\r\n}\r\n\r\nfunction* logout(){\r\n    const auth = getAuth();\r\n    yield put({'type': authTypes.AUTH_SPOTIFY_LOGOUT});\r\n    const { response, error } = yield call(handleSignOut, auth);\r\n    if(error){\r\n        yield put({'type': types.FBASE_SIGN_OUT_ERROR});\r\n    }else{\r\n        yield put({'type': types.FBASE_SIGN_OUT_SUCCESS});\r\n    }\r\n}\r\n\r\nfunction* handleSetRef(action){\r\n    const uid = yield select(getUid);\r\n    if(uid){\r\n        const db = yield call(getDatabase);\r\n        set(ref(db, '/persistedState/' + uid + '/' + action.endpoint), action.value)\r\n    }\r\n}\r\n\r\nfunction* persistToken(action){\r\n    yield call(handleSetRef, {endpoint: \"spotify\", value: {token: action.token, expires_at: localStorage.getItem(\"spotifyExpiration\")} });\r\n}\r\n\r\nfunction* listenForToken(){\r\n    while(true){\r\n        yield take(types.FBASE_SET_UID);\r\n        const uid = yield select(getUid);\r\n        if (uid) {\r\n            const db = yield call(getDatabase);\r\n            const tokenRef = yield call(ref, db, '/persistedState/' + uid + '/spotify');\r\n            onValue(tokenRef, (snapshot) => {\r\n                const data = snapshot.val();\r\n                if(data !== null && data !== 'null'){\r\n                    let tokenExpiration = new Date(Date.parse(data.expires_at));\r\n                    if(!isDateExpiredIn(tokenExpiration, 600)){ // token should be valid for at least 10 minutes\r\n                        store.dispatch({ 'type': authTypes.AUTH_SPOTIFY, token: data.token, expires_in: tokenExpiration });\r\n                    }else{\r\n                        store.dispatch({'type': authTypes.AUTH_SPOTIFY_LOGOUT});\r\n                    }\r\n                }\r\n            })\r\n        }\r\n    }\r\n}\r\n\r\nfunction* fbaseRootSaga() {\r\n    while(true){\r\n        const tokenListener = yield fork(listenForToken);\r\n        // set up connection to firebase\r\n        yield call(initializeFirebase);\r\n        yield call(authenticateFirebase);\r\n        \r\n        const tasks = yield all([\r\n            takeLeading(authTypes.AUTH_SPOTIFY, persistToken),\r\n        ]);\r\n        // listen for signout action\r\n        yield take(types.FBASE_SIGN_OUT);\r\n        yield cancel(tokenListener);\r\n        yield cancel(tasks);\r\n        yield call(logout);\r\n    }\r\n};\r\n\r\nconst getUid = (state) => state.fbase.uid;\r\n\r\nexport default fbaseRootSaga;","// src/api/spotifyUtil.js\r\n\r\nconst baseUrl = \"https://api.spotify.com/v1\";\r\n\r\nconst requestTypes = {\r\n    GET: \"GET\",\r\n    POST: \"POST\",\r\n    PUT: \"PUT\",\r\n    DELETE: \"DELETE\"\r\n}\r\n\r\nfunction handleHttpResponse(response){\r\n    return response.json().then(\r\n        (json) => {\r\n            if(!response.ok) {\r\n                let startObj = (response.status === 429) ? {retry_after: response.headers.get('retry-after')} : {};\r\n                const error = Object.assign(startObj, json, {\r\n                    status: response.status,\r\n                    statusText: response.statusText\r\n                });\r\n\r\n                return Promise.reject(error);\r\n            }\r\n            return json;\r\n        });\r\n}\r\n\r\nconst spotifyApiCall = (token, endpoint, method=\"GET\", bodyObj={}, content_type=\"application/json\") => {\r\n    // add slash if missing\r\n    const finalEndpoint = (endpoint.startsWith(\"/\")) ? endpoint : \"/\" + endpoint;\r\n    // embed token\r\n    const headers = {\r\n        'Authorization': ('Bearer ' + token),\r\n    }\r\n    const parameters = {\r\n        method: method,\r\n        headers: headers\r\n    }\r\n    // add the body object to the parameters if it isn't empty\r\n    if(Object.keys(bodyObj).length !== 0){\r\n        parameters[\"body\"] = JSON.stringify(bodyObj);\r\n        headers[\"Content-Type\"] = content_type;\r\n    }\r\n    \r\n    return fetch(baseUrl+finalEndpoint, parameters).then(handleHttpResponse).then(response => ({response}) ).catch(error => ({error}) );\r\n}\r\n\r\nexport { baseUrl, requestTypes, spotifyApiCall };","import { spotifyApiCall } from './spotifyUtil';\n\n\nconst getSearchResults = (token, searchQuery, searchTypes, pageInfo=\"&offset=0&limit=20\") => {\n    const baseEndpoint = '/search';\n    const typesListString = searchTypes.reduce((tot,type,i,arr) => {\n        if (arr.length-1!==i){\n            return (tot + type + ',');\n        }else return (tot + type);\n    });\n    const queryEndpoint = '?q=' + encodeURIComponent(searchQuery) + '&type=' + encodeURIComponent(typesListString) + \"&market=from_token\";\n    \n    return spotifyApiCall(token, baseEndpoint + queryEndpoint + pageInfo);\n}\n\n\n\nexport { getSearchResults };","// src/state/search/searchSagas.js\r\nimport { call, cancel, select, all, put, take, takeLatest } from 'redux-saga/effects';\r\nimport * as types from './searchTypes';\r\nimport * as fbaseTypes from '../fbase/fbaseTypes';\r\nimport { getSearchResults } from \"../../api/spotifySearch\";\r\nimport { baseUrl, spotifyApiCall } from \"../../api/spotifyUtil\";\r\n\r\nfunction* getSearch(action){\r\n    const resultTypes = yield select(getResultTypes);\r\n    const {response, error} = yield call(getSearchResults, action.token, action.query, resultTypes);\r\n    if (error){\r\n        //Fetching API failed\r\n        yield put({'type': types.SEARCH_GET_ERROR, payload: error.error});\r\n    }else{\r\n        const data = response.tracks;\r\n        yield put({'type': types.SEARCH_GET_SUCCESS, payload: data});\r\n    }\r\n\r\n}\r\n\r\nfunction* getNextPage(action){\r\n    const nextPage = yield select(getNextPageURL);\r\n    if(nextPage){\r\n        const endpoint = nextPage.slice(baseUrl.length);\r\n        const {response, error} = yield call(spotifyApiCall, action.token, endpoint);\r\n        if(error){\r\n            yield put({'type': types.SEARCH_GET_ERROR, payload: error.error});\r\n        }else{\r\n            const data = response.tracks;\r\n            yield put({'type': types.SEARCH_GET_SUCCESS, payload: data});\r\n        }\r\n    }\r\n}\r\n\r\nfunction* getPrevPage(action){\r\n    const prevPage = yield select(getPrevPageURL);\r\n    if(prevPage){\r\n        const endpoint = prevPage.slice(baseUrl.length);\r\n        const {response, error} = yield call(spotifyApiCall, action.token, endpoint);\r\n        if(error){\r\n            yield put({'type': types.SEARCH_GET_ERROR, payload: error.error});\r\n        }else{\r\n            const data = response.tracks;\r\n            yield put({'type': types.SEARCH_GET_SUCCESS, payload: data});\r\n        }\r\n    }\r\n}\r\n\r\nfunction* searchRootSaga() {\r\n    while(true){\r\n        const tasks = yield all([\r\n            takeLatest(types.SEARCH_GET, getSearch),\r\n            takeLatest(types.SEARCH_NEXT, getNextPage),\r\n            takeLatest(types.SEARCH_PREV, getPrevPage)\r\n            \r\n        ])\r\n        yield take(fbaseTypes.FBASE_SIGN_OUT);\r\n        yield cancel(tasks);\r\n    }\r\n};\r\n\r\nconst getResultTypes = (state) => state.search.resultTypes;\r\nconst getNextPageURL = (state) => state.search.activePage.next;\r\nconst getPrevPageURL = (state) => state.search.activePage.previous;\r\n\r\nexport default searchRootSaga;","// src/api/spotifyUser.js\r\nimport { spotifyApiCall } from './spotifyUtil';\r\n\r\nconst getCurrentUser = (token) => {\r\n    return spotifyApiCall(token, '/me');\r\n}\r\n\r\nexport { getCurrentUser };","// src/state/user/userSagas.js\r\nimport { all, call, put, takeLatest } from 'redux-saga/effects';\r\nimport * as types from './userTypes';\r\nimport * as fbaseTypes from '../fbase/fbaseTypes';\r\nimport { getCurrentUser } from \"../../api/spotifyUser\";\r\n\r\nfunction* getUser(action){\r\n    const { response, error } = yield call(getCurrentUser, action.token);\r\n    if(error){\r\n        // fetching the user from the API failed\r\n        yield put({'type': fbaseTypes.FBASE_SIGN_OUT});\r\n        yield put({'type': types.USER_GET_ERROR, payload: error.error})\r\n    }else{\r\n        // fetching the user from the API succeeded\r\n        const data = response;\r\n        const user = {\r\n            id: data.id,\r\n            display_name: data.display_name,\r\n            country: data.country\r\n        }\r\n        yield put({'type': types.USER_GET_SUCCESS, payload: user});\r\n    }\r\n}\r\n\r\nfunction* userRootSaga() {\r\n    yield all([\r\n        takeLatest(types.USER_GET, getUser)\r\n    ])\r\n};\r\n\r\nexport default userRootSaga;","// src/api/spotifyPlaylist.js\nimport { spotifyApiCall, requestTypes } from './spotifyUtil';\n\nconst fetchPlaylist = (token, offset) => {\n    return spotifyApiCall(token, '/me/playlists?offset='+offset+\"&limit=50\");\n}\n\nconst fetchTrack = (token, playlist_id, offset) => {\n    return spotifyApiCall(token, '/playlists/' + playlist_id + '/tracks?market=from_token&offset='+offset+'&limit=100');\n}\n\nconst moveTrack = (token, playlist_id, range_start, insert_before, snapshot_id) => {\n    return spotifyApiCall(token, '/playlists/' + playlist_id + '/tracks', requestTypes.PUT, {range_start,insert_before,snapshot_id});\n}\n\nconst deleteFromPlaylist = (token, playlist_id, tracks, snapshot_id) => {\n    return spotifyApiCall(token, '/playlists/' + playlist_id + '/tracks', requestTypes.DELETE, {tracks, snapshot_id})\n}\n\n\nconst addToPlaylist = (token, playlist_id, uris) => {\n    return spotifyApiCall(token, '/playlists/' + playlist_id + '/tracks', requestTypes.POST, {uris});\n}\n\nexport { moveTrack, deleteFromPlaylist, fetchPlaylist, fetchTrack, addToPlaylist };","// src/state/playlist/playlistSagas.js\r\nimport { buffers } from 'redux-saga';\r\nimport { delay, all, put, take, takeEvery, takeLeading, call,select, actionChannel, fork, cancel } from 'redux-saga/effects';\r\nimport * as types from './playlistTypes';\r\nimport * as tracksTypes from '../tracks/tracksTypes';\r\nimport * as fbaseTypes from '../fbase/fbaseTypes';\r\nimport { moveTrack, deleteFromPlaylist, fetchPlaylist,fetchTrack,addToPlaylist } from '../../api/spotifyPlaylist'\r\n\r\n\r\nconst getToken = (state) => state.auth.spotify.token;\r\nconst getSearchPage = (state) => state.search.activePage;\r\n\r\nfunction* handleMoveUp(action){\r\n    const token = yield select(getToken);\r\n    const playlistId = action.playlistId;\r\n    const range_start = action.CI;\r\n    const insert_before = action.CI-1;\r\n    const snapshot_id = action.snapshot_id;\r\n    const { response, error } = yield call(moveTrack, token, playlistId, range_start, insert_before, snapshot_id);\r\n    if(!error){      \r\n        yield put({'type': types.PLAYLIST_MOVE_UP_SONG_SUCCESS, payload: {CI: action.CI, snapshot_id: response.snapshot_id}});\r\n    }else{\r\n        yield put({'type': types.PLAYLIST_MOVE_UP_SONG_ERROR, payload: error.error});\r\n    }\r\n}\r\n\r\nfunction* handleMoveDown(action){\r\n    const token = yield select(getToken);\r\n    const playlistId = action.playlistId;\r\n    const range_start = action.CI+1;\r\n    const insert_before = action.CI;\r\n    const snapshot_id = action.snapshot_id;\r\n    const { response, error } = yield call(moveTrack, token, playlistId, range_start, insert_before, snapshot_id);\r\n    if(!error){\r\n        yield put({'type': types.PLAYLIST_MOVE_DOWN_SONG_SUCCESS, payload: {CI: action.CI, snapshot_id: response.snapshot_id}});\r\n    }else{\r\n        yield put({'type': types.PLAYLIST_MOVE_DOWN_SONG_ERROR, payload: error.error});\r\n    }\r\n}\r\n\r\nfunction* handleDeleteFromPlaylist(action){\r\n    const token = yield select(getToken);\r\n    const playlistId = action.playlistId;\r\n    const snapshot_id = action.snapshot_id;\r\n    const trackId = action.trackId;\r\n    const tracks = [{\"uri\": action.track_uri, \"positions\": [action.CI]}];\r\n    const { response, error } = yield call(deleteFromPlaylist, token, playlistId, tracks, snapshot_id);\r\n\r\n    if(!error){\r\n        yield put({'type': tracksTypes.TRACKS_DELETE_LOCATIONS, payload: {playlistId, trackId}});\r\n        yield put({'type': types.PLAYLIST_DELETE_FROM_LIST_SUCCESS, payload: {CI: action.CI, snapshot_id: response.snapshot_id}});\r\n    }else{\r\n        yield put({'type': types.PLAYLIST_DELETE_FROM_LIST_ERROR, payload: error.error});\r\n    }\r\n}\r\n\r\nfunction* handleFetchPlaylist(action){\r\n    yield put({'type': types.PLAYLIST_FETCH_PROGRESS, currentPercentage: 0});\r\n    const token = yield select(getToken);\r\n    let offset = 0;\r\n    let response, error;\r\n    ({ response, error } = yield call(fetchPlaylist, token, offset));\r\n    if(error){\r\n        if(error.status === 401){\r\n            yield put({'type': fbaseTypes.FBASE_SIGN_OUT});\r\n        }\r\n    }else{\r\n        let total = response.total;\r\n        let remainingPlaylists = (total > 50);\r\n        let allPlaylists = response.items;\r\n        while(remainingPlaylists && !error){\r\n            offset += 20;\r\n            ({ response, error } = yield call(fetchPlaylist, token, offset));\r\n            if(!error){\r\n                allPlaylists = allPlaylists.concat(response.items);\r\n            }else if(error.status === 429){\r\n                offset -= 50;\r\n                yield delay(1000*error.retry_after);\r\n            }\r\n            remainingPlaylists = (total > offset+50);\r\n        }\r\n        if(!error){\r\n            const userId = yield select(getUser);\r\n            const ownerPlaylists = allPlaylists.filter(playlist => playlist.owner.id === userId);\r\n            if(total === 0 || ownerPlaylists.length === 0){ // user has no playlists at all\r\n                yield put({'type': types.PLAYLIST_FETCH_PROGRESS, currentPercentage: 100});\r\n                yield put({'type': types.PLAYLIST_GET_SUCCESS, payload: {}});\r\n                yield put({'type': types.PLAYLIST_TRACK_GET_ALL_DONE});\r\n                return;\r\n            }\r\n            yield put({'type': types.PLAYLIST_GET_SUCCESS, payload: {playlists: ownerPlaylists}});\r\n        }else{\r\n            yield put({'type': types.PLAYLIST_GET_ERROR, payload: error.error});\r\n        }\r\n    }\r\n}\r\n\r\nfunction* handleFetchTrack(action){\r\n    const token = yield select(getToken);\r\n    const playlist_id = action.playlistId;\r\n    let offset = 0;\r\n    let response, error;\r\n    ({ response, error } = yield call(fetchTrack, token, playlist_id, offset));\r\n    if(error){\r\n        //console.log(error)\r\n    }else{\r\n        let total = response.total;\r\n        let remainingTracks = (total > 100);\r\n        let allTracks = response.items;\r\n        while(remainingTracks && ! error){\r\n            offset += 100;\r\n            ({ response, error } = yield call(fetchTrack, token, playlist_id, offset));\r\n            if(!error){\r\n                allTracks = allTracks.concat(response.items);\r\n            }else if(error.status === 429){\r\n                offset -= 100;\r\n                yield delay(1000*error.retry_after);\r\n            }else{\r\n                //console.error(error);\r\n            }\r\n            remainingTracks = (total > offset+100);\r\n        }\r\n        if(!error){\r\n            let tracks = allTracks.filter(wt => (!wt.is_local)).map(wrappedTrack => {\r\n                let track = wrappedTrack.track;\r\n                return {\r\n                    album_name: (track.album) ? track.album.name : \"No Album\",\r\n                    album_image: (track.album && track.album.images.length >= 2 && track.album.images[1]) || null,\r\n                    artists: track.artists.map(a=>a.name),\r\n                    is_local: track.is_local,\r\n                    external_urls: track.external_urls,\r\n                    name: track.name,\r\n                    id: track.id,\r\n                    preview_url: track.preview_url,\r\n                    uri: track.uri,\r\n                    duration: track.duration_ms\r\n                };\r\n            });\r\n            let trackIds = response.items.map(wrappedTrack => wrappedTrack.track.id);\r\n            yield put({'type':types.PLAYLIST_TRACK_GET_SUCCESS, payload: {playlist_id, tracks: tracks}})\r\n            yield put({'type':tracksTypes.TRACKS_SAVE_LOCATIONS, payload: {playlist_id, trackIds: trackIds}})\r\n        }else{\r\n            yield put({'type': types.PLAYLIST_TRACK_GET_ERROR, payload: error.error});\r\n\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\nfunction* watchTracksFetch(){\r\n    const buffer = buffers.expanding(10);\r\n    const trackFetchChannel = yield actionChannel(types.PLAYLIST_TRACK_GET, buffer);\r\n    let counter = 0;\r\n    while(counter <= 0 || !buffer.isEmpty()){\r\n        const action = yield take(trackFetchChannel);\r\n        yield call(handleFetchTrack, action);\r\n        counter++;\r\n        const numPlaylists = yield select(getNumPlaylists);\r\n        yield put({'type': types.PLAYLIST_FETCH_PROGRESS, currentPercentage: Math.round((counter/numPlaylists)*100)})\r\n    }\r\n    yield put({'type': types.PLAYLIST_TRACK_GET_ALL_DONE});\r\n}\r\n\r\n\r\nfunction* handleAddToPlaylist(action){\r\n    const token = yield select(getToken);\r\n    const searchPage = yield select(getSearchPage);\r\n    const playlistId = action.playlistId;\r\n    const trackId = action.trackId;\r\n    const uris = [\"spotify:track:\"+ trackId];\r\n    const { response, error } = yield call(addToPlaylist, token, playlistId, uris);\r\n    if(!error){\r\n        const trackObj = (!searchPage) ? null : searchPage.items.filter(t => t.id === trackId)[0];\r\n        yield put({'type': tracksTypes.TRACKS_SAVE_LOCATIONS, payload: {playlist_id: playlistId, trackIds: [trackId]}})\r\n        yield put({'type': types.PLAYLIST_ADD_TO_LIST_SUCCESS, payload: {playlistId, snapshot_id: response.snapshot_id, trackId, trackObj}})\r\n    }\r\n    else{\r\n        yield put({'type': types.PLAYLIST_ADD_TO_LIST_ERROR, payload: error.error})\r\n    }\r\n\r\n}\r\n\r\nfunction* playlistRootSaga() {\r\n    while(true){\r\n        const tasks = yield all([\r\n            takeEvery(types.PLAYLIST_MOVE_UP_SONG, handleMoveUp),\r\n            takeEvery(types.PLAYLIST_MOVE_DOWN_SONG, handleMoveDown),\r\n            takeLeading(types.PLAYLIST_DELETE_FROM_LIST, handleDeleteFromPlaylist),\r\n            takeLeading(types.PLAYLIST_GET,handleFetchPlaylist),\r\n            takeLeading(types.PLAYLIST_ADD_TO_LIST, handleAddToPlaylist),\r\n            fork(watchTracksFetch),\r\n        ])\r\n        yield take(fbaseTypes.FBASE_SIGN_OUT);\r\n        yield cancel(tasks);\r\n    }\r\n\r\n};\r\n\r\n// selectors\r\nconst getUser = (state) => state.user.id;\r\nconst getNumPlaylists = (state) => Object.keys(state.lists.playlists).length;\r\n\r\nexport default playlistRootSaga;\r\n","// src/state/playlist/playlistSagas.js\r\nimport { all } from 'redux-saga/effects';\r\nimport * as types from './tracksTypes';\r\n\r\nfunction* tracksRootSaga(playlistChannel) {\r\n    yield all([\r\n    ])\r\n};\r\n\r\nexport default tracksRootSaga;\r\n","// src/state/rootReducer.js\r\nimport { fork } from 'redux-saga/effects';\r\nimport auth from './auth/authSagas';\r\nimport fbase from './fbase/fbaseSagas';\r\nimport search from './search/searchSagas';\r\nimport user from './user/userSagas';\r\nimport lists from './playlist/playlistSagas';\r\nimport track from './tracks/tracksSagas';\r\n\r\nexport default function* rootSaga() {\r\n\r\n    yield fork(auth);\r\n    yield fork(fbase);\r\n    yield fork(search);\r\n    yield fork(user);\r\n    yield fork(lists);\r\n    yield fork(track);\r\n    // yield fork(module);\r\n}","// src/state/store.js\r\n\r\nimport { createStore, applyMiddleware, compose } from 'redux';\r\nimport rootReducer from './rootReducer';\r\nimport rootSaga from './rootSaga';\r\nimport createSagaMiddleware from 'redux-saga';\r\n\r\nconst reduxDevTools = window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__();\r\n\r\nconst sagaMiddleware = createSagaMiddleware();\r\n\r\nconst store = (process.env.NODE_ENV !== 'production') ? \r\n    createStore(rootReducer, compose(applyMiddleware(sagaMiddleware), reduxDevTools))       // development mode\r\n    : createStore(rootReducer, applyMiddleware(sagaMiddleware));                            // production mode (should not require Redux devtools extension)\r\n\r\nexport default store;\r\n\r\nsagaMiddleware.run(rootSaga);","export default __webpack_public_path__ + \"static/media/LOGO.846060d1.svg\";","// src/state/search/searchActions.js\r\nimport { createAction } from '../utils';\r\nimport * as types from './searchTypes';\r\n\r\nconst actions = {\r\n    initSearch: () => createAction(types.SEARCH_INIT_TEST),\r\n    getSearchResults: (token, query) => createAction(types.SEARCH_GET, {token, query}),\r\n    getNextPage: (token) => createAction(types.SEARCH_NEXT, {token}),\r\n    getPreviousPage: (token) => createAction(types.SEARCH_PREV, {token}),\r\n    setIsTabVisible: (visible) => createAction(types.SEARCH_TAB_VISBILITY, {visible}),\r\n};\r\nexport default actions;","export default __webpack_public_path__ + \"static/media/BGimg.7e2b74e4.png\";","export default __webpack_public_path__ + \"static/media/Search.8d2bd43b.svg\";","// src/views/SearchView.js\r\nimport './SearchView.scss';\r\nimport Form from 'react-bootstrap/Form';\r\nimport BGimg from '../images/BGimg.png';\r\nimport searchicon from '../images/Icons/Search.svg';\r\n// import icons from '/node_modules/bootstrap-icons/icons'\r\nimport React from 'react'\r\n\r\nfunction SearchView(props){\r\n    return (\r\n        <div className=\"searchview\">\r\n            <img\r\n                alt=\"background\"\r\n                src={BGimg}\r\n            />{' '}\r\n\r\n            <div className= 'searchcontainer'>\r\n                <h6>Listify helps you manage and find inspiration for your playlists</h6>\r\n                <div className='s-searchbar'>\r\n                    <form className='s-searchinput'>\r\n                        <Form.Group controlId=\"formSearchInput\">\r\n                            <Form.Control autoFocus={props.tabVisible}\r\n                                type=\"text\" placeholder=\"Search for songs based on its title, artist, or album..\" \r\n                                onChange={e=>props.onSearch(e.target.value)}\r\n                                ref={props.getSearchBarRef()}/> \r\n                        </Form.Group>\r\n                    </form>\r\n                    <img\r\n                            \r\n                        alt=\"\"\r\n                        src= {searchicon}       \r\n                        />{' '}\r\n                </div>\r\n            </div>\r\n            \r\n            \r\n        </div>\r\n  );\r\n}\r\n\r\nexport default SearchView;","export default __webpack_public_path__ + \"static/media/Spotify_Icon.cd66b8f6.png\";","export default __webpack_public_path__ + \"static/media/Inboxes fill.043f2be9.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAZCAYAAAArK+5dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHRSURBVHgB7ZRfTttAEMa/WTt/3QcfITdoOAFwgqZSW0d9IicoPQHpCdobNH0jSiXCCZobkJ4A9wQ1EoRgszPMGiEBckwS8oT4SbGS3fm+yc54h7CA7EN9B8bsYBmYJ5Xf80nRFhUtStT4wjA/sBL81RtePq1JPwdtGwXCUfMIS+JinSb9GLQf75n7P6Rbb3lWnHFMV9UeluQ2VmLP4OhSPRYnYE/NKUzJ7tI4SbAkLtYQ7+rXsJZ7FCSQKPguhLaI6TUO5zFWhFTjtLmHej3YdE11Ncy6b/p4Js7DedmosZ8ndk31LE4IMjbD2XtsANd0AXUsY4ts1DzVPK0ygUCO/eGs82BNy8DAPsqJffckwdSqSVGEB3oHou3H6wzpkFCpTvvR8iGUMMm/ynDWLwrUmk6MyB/51DyYG/5Vn9cT1LID/fctFvQqo9mgSMdRsC3A1Ojx/xLoLRZQOTyfMNE3/fSr4p1yLfvvSuPW/NHFYJFOBKE+z3whSnRehChBk/T1Eg6u2ewJSULkTV3iMg3yVx7HdN0N9rQHPy2nW9VRNsUGcBOB9bRW5xNJJwy5lp489SatQZxPhLuM7vjYEK6MlmS8zkRYmdeL9nrR1uNlXbQbkzZdLHjynWgAAAAASUVORK5CYII=\"","// src/views/SearchResultView.js\r\nimport './SearchResultView.scss';\r\nimport Table from 'react-bootstrap/Table';\r\nimport Button from \"react-bootstrap/Button\";\r\nimport Form from 'react-bootstrap/Form';\r\nimport Card from 'react-bootstrap/Card';\r\nimport spotifyicon from '../images/Icons/Spotify_Icon.png';\r\nimport searchicon from '../images/Icons/Search.svg';\r\nimport trackmarked from '../images/Icons/Inboxes fill.svg';\r\nimport untrackmark from '../images/Icons/Inboxes.png';\r\n\r\n\r\n\r\nfunction SearchResultView(props){\r\n    return (\r\n        <div className= 'searchresultview'>\r\n            <div className= 'searchresultcontainer'>\r\n                <div className='sr-searchbar'>\r\n                    <form className='sr-searchinput'>\r\n                        <Form.Group controlId=\"formSearchInput\">\r\n                            <Form.Control autoFocus defaultValue={props.search} \r\n                                    type=\"text\" placeholder=\"Search for songs based on its title, artist, or album..\"\r\n                                    onChange={e=>props.onSearch(e.target.value)}\r\n                                    ref={props.getSearchBarRef()} />\r\n                       </Form.Group>\r\n                    </form>\r\n                        <img\r\n                                alt=\"search icon\"\r\n                                src= {searchicon}\r\n                            />\r\n                </div>\r\n                <Table size=\"sm\">\r\n                        <thead>\r\n                            <tr>\r\n                            <th class='th-index'> </th>\r\n                            <th class='th-songname text-muted'>Name </th>\r\n                            <th class='th-songartist text-muted'>Artist</th>\r\n                            <th class='th-songalbum text-muted'>Album</th>\r\n                            <th class='th-actions text-muted'>Actions</th>\r\n                            </tr>\r\n                        </thead>\r\n                </Table>\r\n                <div className='resultscontainer'>\r\n\r\n                   { props.results.map((item, index) => {\r\n                       return (\r\n                        <div className='songitem' key={index}>  \r\n                            <div className='cd-cover'>  \r\n                                <img\r\n                                    alt=\"song album cover\"\r\n                                    className=\"songitem-cover\"\r\n                                    src={item.image} \r\n                                    />\r\n                            </div>\r\n                            <Card>\r\n                               <div className='cardcontent'>\r\n                                   <p className=\"cd-name text-muted\">\r\n                                   <a href={item.spotifyUrl}>{item.track}</a>\r\n                                   </p>\r\n                                   <p className=\"cd-artist text-muted\">\r\n                                   <i class=\"fas fa-user\"></i>\r\n                                   {item.artist}\r\n                                   </p>\r\n                                   <p className=\"cd-album text-muted\">\r\n                                   <i class=\"fas fa-record-vinyl\"></i>\r\n                                   {item.album}\r\n                                   </p>\r\n                                   <div className='cd-Actions' > \r\n                                        <div className=\"sr-addsong\">\r\n                                            <div className={(props.isFetchingPlaylists) ? \"dropdown disabled\" : \"dropdown\"} >\r\n                                                <button className=\"dropbtn\"\r\n                                                        disabled={props.isFetchingPlaylists}>\r\n                                                    <i className=\"far fa-plus-square\"></i>\r\n                                                </button>\r\n                                            \r\n                                            \r\n                                                <div className=\"dropdown-content\" onClick={props.notify}>\r\n                                                    {props.playlists.map((list) => {\r\n                                                            return (\r\n                                                                <p onClick={() => props.onAddToPlaylist(list.id, item.id)} className=\"playlist-dropdown-p\">{list.name}</p>\r\n                                                            )\r\n                                                        })\r\n                                                    }\r\n                                                </div>\r\n                                                \r\n                                            </div>\r\n                                            \r\n                                        </div>\r\n                                \r\n                                       <Button variant=\"light\" onClick={(item.isInStash) ? (() => props.onDeleteFromTracks(index)) : (()=>props.onAddToTracks(index))}>\r\n                                           <img\r\n                                                alt=\"remove from track stash\"\r\n                                                src={(item.isInStash) ? (trackmarked) : (untrackmark) } />\r\n                                       </Button>\r\n                                       \r\n                                       <a target=\"_blank\" rel=\"noreferrer\" href={item.spotifyUrl}>\r\n                                           {/* Open Spotify */}\r\n                                            <img\r\n                                                alt=\"open song in Spotify\"\r\n                                                src={spotifyicon}\r\n                                                className='openinspotify'\r\n                                                />\r\n                                        </a>\r\n                                    </div>\r\n                               </div>\r\n                       </Card>\r\n                       </div>\r\n                       )\r\n                    })}\r\n                    <div className=\"Pagenav\">\r\n                        <nav>\r\n                            <ul class=\"pagination\">\r\n                                <li class={(props.currentPage===1) ? \"page-item disabled\" : \"page-item\"}>\r\n                                <span class=\"page-link\" aria-label=\"Previous\" onClick={props.onPrevPage} disabled={props.currentPage===1}>\r\n                                    <span aria-hidden=\"true\"></span>\r\n                                    <span class=\"sr-only\">Previous</span>\r\n                                    Previous\r\n                                </span>\r\n                                </li>\r\n                              \r\n                                <li class={(props.currentPage===props.numPages) ? \"page-item disabled\" : \"page-item\"}>\r\n                                <span class=\"page-link\" aria-label=\"Next\" onClick={props.onNextPage} disabled={props.currentPage===props.numPages}>\r\n                                    <span aria-hidden=\"true\"></span>\r\n                                    <span class=\"sr-only\">Next</span>\r\n                                    Next\r\n                                </span>\r\n                                </li>\r\n                            </ul>\r\n                            <p>Page {props.currentPage} out of {props.numPages}</p>\r\n                        </nav>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n  );\r\n}\r\n\r\nexport default SearchResultView;","// src/state/tracks/tracksActions.js\nimport { createAction } from '../utils';\nimport * as types from './tracksTypes';\n\nconst actions = {\n    deleteFromList: ( playlistId) => createAction(types.TRACKS_DELETE_LOCATIONS, {playlistId}),\n    addToTracks: (trackId, track) => createAction(types.PLAYLIST_ADD_TO_TRACKS, {trackId, track}),\n    deleteFromTracks: (CI, trackId) => createAction(types.DELETE_FROM_TRACKS, {CI, trackId}),\n};\n\nexport default actions;","// src/state/playlist/playlistActions.js\nimport { createAction } from '../utils';\nimport * as types from './playlistTypes';\n\nconst actions = {\n    moveUpSong: (token, playlistId, CI, snapshot_id) => createAction(types.PLAYLIST_MOVE_UP_SONG, {token, playlistId, CI, snapshot_id}),\n    moveDownSong: (token, playlistId, CI, snapshot_id) => createAction(types.PLAYLIST_MOVE_DOWN_SONG, {token, playlistId, CI, snapshot_id}),\n    deleteFromList: ( token, playlistId, track_uri, snapshot_id, CI, trackId ) => createAction(types.PLAYLIST_DELETE_FROM_LIST, { token, playlistId, track_uri, snapshot_id, CI, trackId}),\n    fetchPlaylists: (token) => createAction(types.PLAYLIST_GET, {token}), \n    fetchTrack: (token, playlistId) => createAction(types.PLAYLIST_TRACK_GET, {token, playlistId}),\n    selectPlaylist: (playlistId) => createAction(types.PLAYLIST_SELECT, {playlistId}),\n    addToPlaylist: (token, playlistId, trackId) => createAction(types.PLAYLIST_ADD_TO_LIST, {token, playlistId, trackId})\n};\n\nexport default actions;","import React, { useRef } from \"react\";\nimport {useState, useEffect} from \"react\";\nimport { connect } from 'react-redux';\nimport searchActions from '../state/search/searchActions';\nimport SearchView from '../views/SearchView';\nimport SearchResultView from '../views/SearchResultView';\nimport tracksActions from '../state/tracks/tracksActions';\nimport playlistActions from '../state/playlist/playlistActions';\nimport { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\n\n\n\nfunction setNextPage(currentPage, numPages, setPage){\n    if(currentPage === numPages) return;\n    setPage(currentPage+1);\n}\nfunction setPrevPage(currentPage, setPage){\n    if(currentPage === 0) return;\n    setPage(currentPage-1);\n}\n\ntoast.configure();\nfunction SearchPresenter(props) {\n    const [search, setSearch] = useState(\"\");\n    const { token, isTabVisible } = props;\n    const searchBarRef = useRef(null);\n\n    useEffect(() =>{\n        if (!search) return;\n        props.getSearchResults(token, search);\n    }, [search])\n\n    // focus search bar when the search (result) view is visible\n    useEffect(()=>{\n        if(isTabVisible){\n            if(searchBarRef && searchBarRef.current)\n                searchBarRef.current.focus();\n        }\n    }, [isTabVisible, searchBarRef]);\n\n    const [page, setPage] = useState(1);\n    const numPages = Math.ceil(props.totalResults/20);\n    const addToTracks = (CI) => props.addToTracks(props.results[CI].id, props.rawItems[CI]);\n    const deleteFromTracks = (CI) => props.deleteFromTracks(CI, props.results[CI].id);\n    const addToPlaylist = (playlistId, trackId) => props.addToPlaylist(token,playlistId, trackId);\n\n    const notify = () => {\n        if(token && props.results && props.playlists){\n            toast.success(\"Add to playlist successfully!\")\n        }\n        else{\n            toast.error(\"Ops, something wrong!\")\n        }\n        \n    };\n\n    return (search) ?\n        <SearchResultView   onSearch={(term)=>setSearch(term)} search={search}\n                            results={props.results} currentPage={page}\n                            numPages={numPages}\n                            onNextPage={() => {\n                                setNextPage(page, numPages, setPage);\n                                props.getNextPage(token);\n                            }}\n                            onPrevPage={() => {\n                                setPrevPage(page, setPage);\n                                props.getPreviousPage(token);\n                            }}\n                            tabVisible={isTabVisible}\n                            getSearchBarRef={() => searchBarRef}\n                            onAddToTracks={addToTracks}\n                            onDeleteFromTracks={deleteFromTracks}\n                            playlists={props.playlists}\n                            onAddToPlaylist={addToPlaylist}\n                            notify={notify}\n                            isFetchingPlaylists={props.isFetchingPlaylists}\n        /> : \n        <SearchView onSearch={(term)=>setSearch(term)} tabVisible={isTabVisible} getSearchBarRef={() => searchBarRef} />\n       \n\n}\n\nconst mapStateToProps = (state) => { \n    let totalResults = (state.search.activePage && state.search.activePage.total) || 0; \n    let itemsArray = [];\n    let playlists = [];\n    if(state.search.activePage){\n        itemsArray = state.search.activePage.items.map( (item) => {\n            let artistString = item.artists.reduce((tot,artist,i,arr) => {\n                if (arr.length-1!==i){\n                    return (tot + artist.name + ', ');\n                }else return (tot + artist.name);\n            }, \"\");\n            let smallestAlbumImage = item.album.images.reduce(\n                (smallest, image) => {\n                    if (image.height < smallest.height) return image\n                    return smallest\n                }, \n                item.album.images[0]\n            );\n            let trackMinutes = Math.floor((item.duration_ms/1000)/60);\n            let trackSeconds = Math.round((item.duration_ms - trackMinutes * 1000 * 60)/1000);\n            let isInStash = state.tracks.stash.includes(item.id);\n            return {\n                artist: artistString,\n                album: item.album.name,\n                track: item.name,\n                spotifyUrl: item.external_urls.spotify,\n                image: smallestAlbumImage.url,\n                duration: trackMinutes + \":\" + trackSeconds,\n                previewSong: item.preview_url,\n                id: item.id,\n                isInStash: isInStash,\n            };\n        });\n        playlists = Object.values(state.lists.playlists).map(list => {\n            return {name: list.name, id: list.id};\n        });\n    }\n    \n    return {\n        totalResults: totalResults,\n        results: itemsArray,\n        token: state.auth.spotify.token,\n        rawItems: (state.search.activePage && state.search.activePage.items) || null,\n        isTabVisible: state.search.isTabVisible,\n        playlists: playlists,\n        isFetchingPlaylists: !state.lists.playlistsFetched || !state.lists.tracksFetched,\n    };\n}\n  \nconst mapDispatchToProps = {\n    getSearchResults: searchActions.getSearchResults,\n    getNextPage: searchActions.getNextPage,\n    getPreviousPage: searchActions.getPreviousPage,\n    addToTracks: tracksActions.addToTracks,\n    deleteFromTracks: tracksActions.deleteFromTracks,\n    addToPlaylist: playlistActions.addToPlaylist\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchPresenter);\n","// src/views/PlaylistView.js\nimport './PlaylistView.scss';\nimport Table from 'react-bootstrap/Table'\nimport Card from 'react-bootstrap/Card'\nimport trackmarkicon from '../images/Icons/Inboxes fill.svg'\nimport nottrackedicon from '../images/Icons/Inboxes.png'\nimport LOGO from '../images/LOGO.svg';\n// import icons from '/node_modules/bootstrap-icons/icons'\nimport React from 'react'\nimport { ButtonGroup } from 'react-bootstrap';\nimport spotifyicon from '../images/Icons/Spotify_Icon.png';\n\n\nfunction PlaylistView(props){\n    return (\n    \n        <div className=\"playlistview\">\n            <div className=\"playlistsnav\"> \n                {props.allPlaylists && (props.allPlaylists.map((playlist,i) => {\n                    return (\n                        <div key={i} className={(\n                            (props.selectedPlaylist && props.selectedPlaylist === playlist.id) || (!props.selectedPlaylist && i === 0)) ?\n                                'selectedplaylist': \"unselectedplaylist\"} \n                                onClick = {() => props.onSelectPlaylist(playlist.id)}\n                        >\n                            <img className={(playlist.image) ? \"\" : \"no-img\"} alt=\"playlists\" src={(playlist.image)?playlist.image.url: LOGO}></img>\n                            <p className=\"h6 text-light\">{playlist.name}</p>\n                        </div>\n                    )\n                })) || <p className=\"no-playlists-text\">Your account has no playlists yet.</p>}\n\n            </div>\n            <div className=\"playlistcontent\">\n                <div className=\"playlistbanner\">\n                    <img alt=\"selected playlist\" className={(props.playlist && props.playlist.image) ? \"\" : \"no-img\"}\n                            src={(props.playlist && props.playlist.image) ? props.playlist.image.url : LOGO} />\n                    <div className=\"playlistinfo\">\n                        <div className=\" h4 text-light\">{props.playlist && props.playlist.name || \"\"}</div>\n                        <p className=\" md text-light\">{props.playlist && props.playlist.description || \"\"}</p>\n                    \n                        <form className=\"actionsbar\">\n                            <div className= \"form-group\">\n                                <input type=\"text\" class=\"form-control\" id=\"PlaylistSearchAction\" placeholder=\"Filter songs..\"  defaultValue={props.searchTerm} onChange={e=>props.onSearchTerm(e.target.value)}/>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n\n                <Table className=\"p-tabletitle\" size=\"sm\" >\n                    <thead>\n                        <tr>\n                        <th>#</th>\n                        <th>Actions</th>\n                        </tr>\n                    </thead>\n                </Table>\n                <div className='songscontainer'>\n                    {props.tracks.map((track, index, list)=> {\n                        return (\n                            <div key={index} className='p-songitem'>\n                                <h6>{index+1}</h6>\n                                <img className=\"p-songcover\"\n                                    alt=\"song album cover\"\n                                    src={(track.image) ? track.image.url : LOGO}\n                                    width= '48px'\n                                    height= '48px'\n                                    />\n                            <Card borderless='1'>\n                                    <div className=\"p-cardbody\">\n                                            <div className='p-cardcontent'>\n                                                <div className=\"p-songname\">\n                                                    {track.name}\n                                                </div>\n                                                <div className=\"p-songartist\">\n                                                    <i className=\"fas fa-user\"></i>\n                                                    {track.artist}\n                                                </div>\n                                                <div className=\"p-songalbum\">\n                                                    <i className=\"fas fa-record-vinyl\"></i>\n                                                    {track.album_name}\n                                                </div>\n                                            </div>\n                                            \n                                            <div className=\"p-actions\">\n                                                <div onClick={(track.isInStash) ? (() => props.onDeleteFromTracks(index)) : (()=>props.onAddToTracks(index))}>\n                                                {(track.isInStash) ? (<button className='trackmarked'>\n                                                    <img\n                                                        alt=\"add to track stash\"\n                                                        src={trackmarkicon}\n                                                        />\n                                                </button>)\n                                                : (<button className=\"nottrackmarked\" >\n                                                    <img alt=\"remove from track stash\"\n                                                        src={nottrackedicon}\n                                                        />\n                                                </button>)\n                                                }\n                                                </div>\n                                                <a target=\"_blank\" rel=\"noreferrer\" href={track.spotifyUrl}>\n                                                <img\n                                                alt=\"open song in Spotify\"\n                                                src={spotifyicon}\n                                                className='openinspotify'\n                                                />\n                                                </a>\n                                                \n                                                <ButtonGroup>\n                                                <button disabled={!props.actionsDisabled || index===0} onClick={()=> props.onMoveUpSong(index)}>\n                                                    <i className=\"far fa-arrow-alt-circle-up\"></i>\n                                                </button>\n                                                <button disabled={!props.actionsDisabled || index===list.length-1} onClick={()=> props.onMoveDownSong(index)}>\n                                                    <i className=\"far fa-arrow-alt-circle-down\"></i>\n                                                </button>\n                                                <button disabled={!props.actionsDisabled} onClick={()=> props.onDeleteSong(index)}>\n                                                    <i className=\"far fa-minus-square\"></i>\n                                                </button>\n\n                                                </ButtonGroup>\n\n                                            \n                                            </div>\n                                            \n                                    </div>\n                                </Card>\n                            </div>\n                        )\n                        \n                    })}\n                    \n                </div>\n            </div>\n        </div>\n    \n    );\n}\n\nexport default PlaylistView;","// src/views/LoadingView.js\r\nimport './LoadingView.scss';\r\n\r\nfunction LoadingView(props){\r\n    const { size, percentage } = props;\r\n    const sizeClass = (size === \"xs\") ? \"loading-view-xs\" : (\r\n        (size === \"sm\") ? \"loading-view-sm\" : (\r\n        (size === \"md\") ? \"loading-view-md\" : (\r\n        \"loading-view-lg\" // size === \"lg\" (default)\r\n    )));\r\n    return (\r\n        <div className={\"loading-view \" + sizeClass}>\r\n            <div className=\"lds-ring\">\r\n                <div></div>\r\n                <div></div>\r\n                <div></div>\r\n                {(percentage !== null && typeof percentage !== 'undefined') && (<p className=\"loading-percentage\">{percentage+\"%\"}</p>)}\r\n            </div>\r\n        </div>\r\n  );\r\n}\r\n\r\nexport default LoadingView;","// src/presenters/PlaylistPresenter.js\r\nimport { useEffect, useState } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport PlaylistView from '../views/PlaylistView';\r\nimport LoadingView from '../views/LoadingView';\r\nimport playlistActions from '../state/playlist/playlistActions';\r\nimport tracksActions from '../state/tracks/tracksActions';\r\nimport FuzzySearch from 'fuzzy-search';\r\n\r\nfunction PlaylistPresenter(props){\r\n    const { token, playlists, playlistsFetched, tracksFetched, playlist, playlistTracks, allPlaylists, selectedPlaylist  } = props;\r\n\r\n    useEffect(()=>{\r\n        if(token)\r\n            props.fetchPlaylists(token);\r\n    },[])\r\n\r\n    useEffect(()=>{\r\n        if(playlistsFetched && Object.keys(playlists).length !== 0 && !tracksFetched){\r\n            Object.values(playlists).forEach(list => {\r\n                if(!list.tracks){\r\n                    props.fetchTracks(token, list.id);\r\n                }\r\n            });\r\n        }\r\n    },[playlistsFetched])\r\n    \r\n    const updateSelectedPlaylist = (playlistId) => props.selectPlaylist(playlistId);\r\n    const moveUpSong = (CI) => props.moveUpSong(token, playlist.id, CI, playlist.snapshot_id);\r\n    const moveDownSong = (CI) => props.moveDownSong(token, playlist.id, CI, playlist.snapshot_id);\r\n    const deleteFromList = (CI) => props.deleteFromList(token, playlist.id, playlistTracks[CI].uri, playlist.snapshot_id, CI, playlist.tracks[CI]); \r\n    const addToTracks = (CI) => props.addToTracks(playlist.tracks[CI], playlistTracks[CI]);\r\n    const deleteFromTracks = (CI) => props.deleteFromTracks(CI, playlist.tracks[CI]);\r\n\r\n    const [searchTerm, setSearchTerm] = useState(\"\");\r\n    const [searchResults, setSearchResults] = useState(playlistTracks);\r\n    const preSearchTracks = (playlistTracks || []);\r\n\r\n    useEffect(()=>{\r\n        if(searchTerm){\r\n            const searcher = new FuzzySearch(preSearchTracks, ['name','artist','album_name'], {\r\n                caseSensitive: false,\r\n            })\r\n            setSearchResults(searcher.search(searchTerm));\r\n        }else if(preSearchTracks){\r\n            setSearchResults(preSearchTracks);\r\n        }\r\n\r\n    },[searchTerm, playlistTracks])\r\n\r\n\r\n    return ( (playlist && playlists && searchResults && allPlaylists && playlistTracks && tracksFetched) ||\r\n            playlistsFetched && tracksFetched && Object.keys(playlists).length === 0) ? \r\n            <PlaylistView   onSelectPlaylist = {updateSelectedPlaylist} \r\n                            onMoveUpSong = {moveUpSong}\r\n                            onMoveDownSong = {moveDownSong}\r\n                            onDeleteSong = {deleteFromList}\r\n                            tracks = {searchResults}\r\n                            allPlaylists = {allPlaylists}\r\n                            playlist = {playlist}\r\n                            selectedPlaylist={selectedPlaylist}\r\n                            onAddToTracks={addToTracks}\r\n                            onDeleteFromTracks={deleteFromTracks}\r\n                            onSearchTerm={(term)=>setSearchTerm(term)}\r\n                            searchTerm={searchTerm}\r\n                            actionsDisabled={(searchTerm == false)}\r\n    /> : <LoadingView percentage={props.fetchProgress}/>\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    let selectedPlaylistData = null;\r\n    let allPlaylists = null;\r\n    let playlistTracks = null;\r\n    if(state.lists.playlistsFetched && Object.keys(state.lists.playlists).length > 0){\r\n        // retrieve the focused playlist\r\n        if(state.lists.selectedList){\r\n            selectedPlaylistData = state.lists.playlists[state.lists.selectedList];\r\n        }\r\n        else{\r\n            selectedPlaylistData = Object.values(state.lists.playlists)[0];\r\n        }\r\n\r\n        // retrieve the tracks of the focused playlist\r\n        if(selectedPlaylistData.tracks){\r\n            playlistTracks = selectedPlaylistData.tracks.map(trackId => {\r\n                let trackObj = state.lists.trackIndex[trackId];\r\n                let artistString = trackObj.artists.reduce((tot,artist,i,arr) => {\r\n                    if (arr.length-1!==i){\r\n                        return (tot + artist + ', ');\r\n                    }else return (tot + artist);\r\n                }, \"\");\r\n\r\n                let trackMinutes = Math.floor((trackObj.duration/1000)/60);\r\n                let trackSeconds = Math.round((trackObj.duration - trackMinutes * 1000 * 60)/1000);\r\n                let isInStash = state.tracks.stash.includes(trackObj.id);\r\n\r\n                return {\r\n                    name: trackObj.name,\r\n                    album_name: trackObj.album_name,\r\n                    artist: artistString,\r\n                    spotifyUrl: trackObj.external_urls.spotify,\r\n                    duration: trackMinutes + \":\" + trackSeconds,\r\n                    previewSong: trackObj.preview_url,\r\n                    image: trackObj.album_image,\r\n                    isInStash: isInStash,\r\n                    uri: trackObj.uri,\r\n                    id: trackObj.id\r\n                }\r\n            })\r\n        }\r\n\r\n        // create array containing relevant info about all playlists\r\n        allPlaylists = Object.values(state.lists.playlists).map((playlist) => ({\r\n            name: playlist.name,\r\n            image: playlist.image,\r\n            id: playlist.id,\r\n        }))\r\n\r\n    }\r\n    return ({\r\n        token: state.auth.spotify.token,\r\n        selectedPlaylist: state.lists.selectedList,\r\n        playlists: state.lists.playlists,\r\n        playlist: selectedPlaylistData,\r\n        playlistsFetched: state.lists.playlistsFetched,\r\n        tracksFetched: state.lists.tracksFetched,\r\n        playlistTracks: playlistTracks,\r\n        allPlaylists: allPlaylists,\r\n        fetchProgress: state.lists.fetchProgress,\r\n    });\r\n}\r\n  \r\nconst mapDispatchToProps = {\r\n    fetchPlaylists: playlistActions.fetchPlaylists,\r\n    fetchTracks: playlistActions.fetchTrack,\r\n    selectPlaylist: playlistActions.selectPlaylist,\r\n    moveUpSong: playlistActions.moveUpSong,\r\n    moveDownSong: playlistActions.moveDownSong,\r\n    deleteFromList: playlistActions.deleteFromList,\r\n\r\n    addToTracks: tracksActions.addToTracks,\r\n    deleteFromTracks: tracksActions.deleteFromTracks,\r\n\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PlaylistPresenter);","// src/views/TracksView.js\nimport './TracksView.scss';\nimport Table from 'react-bootstrap/Table';\nimport Button from \"react-bootstrap/Button\";\nimport Card from 'react-bootstrap/Card';\nimport trackmarked from '../images/Icons/Inboxes fill.svg';\n// import icons from '/node_modules/bootstrap-icons/icons'\nimport React from 'react'\nimport spotifyicon from '../images/Icons/Spotify_Icon.png';\n\n\nfunction TracksView(props){\n    return (\n        <div className=\"tracksview\">\n            <div className=\"pagetitle\">\n                <p className=\"h5\">Tracks</p>\n                <img\n                    alt=\"tracks page logo\"\n                    src= {trackmarked}\n                />\n            </div>\n        \n           <div className=\"trackstable\">\n                <Table className=\"t-tabletitle\" size=\"sm\" >\n                    <thead>\n                        <tr>\n                        <th className=\"text-light\"> </th>\n                        <th className=\"text-light\">Actions</th>\n                        </tr>\n                    </thead> \n                </Table>\n                <div className='trackscontainer'>\n                    \n                    { ((props.tracks === null || props.tracks.length === 0) && (\n                        <span className=\" new-playlist text-light\" >\n                        Add tracks from your Playlist or search for new songs to add!\n                        </span>\n                    )) || props.tracks.map((track, index) => {\n                    return(\n                    <div className='t-songitem'> \n                        <img className='t-songcover'\n                             alt=\"song album cover\"\n                             src={track.image.url}\n                            />\n                       <Card borderless='1'>\n                            <div className=\"cardbody\">\n                                    <div className='cardcontent'>\n                                        <div className=\"song-name\">\n                                        {track.name}\n                                        </div>\n                                        <div className=\"song-artist\">\n                                            <i className=\"fas fa-user\"></i>\n                                            {track.artist}\n                                        </div>\n                                        <div className=\"song-album\">\n                                            <i className=\"fas fa-record-vinyl\"></i>\n                                            {track.album_name}\n                                        </div>\n                                    </div>\n                                    <div className=\"t-actions\">\n                                        <div className=\"sr-addsong\">\n                                            <div className={(props.isFetchingPlaylists) ? \"dropdown disabled\" : \"dropdown\"}> \n                                                <button className=\"dropbtn\"\n                                                        disabled={props.isFetchingPlaylists}>\n                                                    <i className=\"far fa-plus-square\"></i>\n                                                </button>\n                                            \n                                            \n                                                <div className=\"dropdown-content\" onClick={props.notify}>\n                                                    {props.playlists.map((list) => {\n                                                            return (\n                                                                <p onClick={() => props.onAddToPlaylist(list.id, track.id)} className=\"playlist-dropdown-p\">{list.name}</p>\n                                                            )\n                                                        })\n                                                    }\n                                                </div>\n                                                \n                                            </div>\n                                            \n                                        </div>\n\n                                        <Button variant=\"light\" className=\"btn-sm\" onClick={()=>props.onDeleteTrack(index)}>\n                                           <img\n                                                alt=\"remove from track stash\"\n                                                src={trackmarked} \n                                                width='16px'\n                                                height= '16px'/>\n                                       </Button>\n\n\n                                       <a href={track.spotifyUrl}>\n                                           {/* Open Spotify */}\n                                            <img\n                                                alt=\"open song in Spotify\"\n                                                src={spotifyicon}\n                                                className='openinspotify'\n                                                />\n                                        </a>\n                                    </div>\n                            </div>\n                        </Card>\n                    </div>);\n                    \n                    })}\n                </div>\n           \n\n            </div>\n        </div>\n\n          );\n}\n\n\n\nexport default TracksView;","import { useEffect } from \"react\";\nimport { connect } from 'react-redux';\nimport TracksView from '../views/TracksView';\nimport tracksActions from '../state/tracks/tracksActions';\nimport playlistActions from '../state/playlist/playlistActions';\nimport { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nfunction TracksPresenter(props){\n    const { token } = props;\n    useEffect(()=>{\n        toast.configure();\n    }, []);\n\n    const deleteFromTracks = (CI) => props.deleteFromTracks(CI);\n    const addToPlaylist = (playlistId, trackId) => props.addToPlaylist(token, playlistId, trackId);\n\n    const notify = () => {\n        if (token && props.results && props.playlists) {\n            toast.success(\"Add to playlist successfully!\")\n        }\n        else {\n            toast.error(\"Ops, something wrong!\")\n        }\n\n    };\n\n    return (\n        <TracksView tracks={props.results}\n            onDeleteTrack={deleteFromTracks}\n            playlists={props.playlists}\n            onAddToPlaylist={addToPlaylist}\n            notify={notify}\n            isFetchingPlaylists={props.isFetchingPlaylists}\n        />\n    )\n\n}\n\nconst mapStateToProps = (state) => { \n    let tracksArray = state.tracks.stash;\n    let stashTracks = null;\n    let playlists = [];\n    if(tracksArray){\n        stashTracks = tracksArray.map(trackId => {\n            let trackObj = state.lists.trackIndex[trackId];\n            let artistString = trackObj.artists.reduce((tot,artist,i,arr) => {\n                if (arr.length-1!==i){\n                    return (tot + artist + ', ');\n                }else return (tot + artist);\n            }, \"\");\n\n            let trackMinutes = Math.floor((trackObj.duration/1000)/60);\n            let trackSeconds = Math.round((trackObj.duration - trackMinutes * 1000 * 60)/1000);\n\n            return {\n                name: trackObj.name,\n                album_name: trackObj.album_name,\n                artist: artistString,\n                spotifyUrl: trackObj.external_urls.spotify,\n                duration: trackMinutes + \":\" + trackSeconds,\n                previewSong: trackObj.preview_url,\n                image: trackObj.album_image,\n                uri: trackObj.uri,\n                id: trackObj.id\n            }\n        });\n        playlists = Object.values(state.lists.playlists).map(list => {\n            return {name: list.name, id: list.id};\n        });\n    }\n\n    return {\n        results: stashTracks,\n        token: state.auth.spotify.token,\n        playlists: playlists,\n        isFetchingPlaylists: !state.lists.playlistsFetched || !state.lists.tracksFetched,\n    };\n}\n  \nconst mapDispatchToProps = {\n    deleteFromTracks: tracksActions.deleteFromTracks,\n    addToPlaylist: playlistActions.addToPlaylist\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TracksPresenter);\n","// src/views/AuthorizedView.js\r\nimport './AuthorizedView.scss';\r\nimport { Tab, Navbar } from \"react-bootstrap\";\r\nimport Nav from 'react-bootstrap/Nav';\r\nimport LOGO from '../images/LOGO.svg';\r\nimport NavDropdown from \"react-bootstrap/NavDropdown\";\r\nimport SearchPresenter from '../presenters/SearchPresenter';\r\nimport PlaylistPresenter from '../presenters/PlaylistPresenter';\r\nimport TracksPresenter from '../presenters/TracksPresenter';\r\n\r\n\r\n\r\nfunction AuthorizedView(props){\r\n    return (\r\n        <div className=\"authorized-view\">\r\n            <Tab.Container id=\"left-tabs-example\" defaultActiveKey=\"playlist\">\r\n            <Nav id=\"navbar\" className=\"navbar\">\r\n            <Nav variant=\"tabs\" className=\"mr-auto\" id=\"nav-container\">\r\n                    <Nav.Item>\r\n                        <Nav.Link eventKey=\"playlist\" onClick={props.onTabClick}>Playlist</Nav.Link>\r\n                    </Nav.Item>\r\n                    <Nav.Item>\r\n                        <Nav.Link eventKey=\"search\" onClick={props.onSearchTabClick}>Search</Nav.Link>\r\n                    </Nav.Item>\r\n                    <Nav.Item>\r\n                        <Nav.Link eventKey=\"tracks\" onClick={props.onTabClick}>Tracks</Nav.Link>\r\n                    </Nav.Item>\r\n            </Nav>\r\n            <Nav>\r\n                <NavDropdown title={props.username}>\r\n                    <NavDropdown.Item onClick={props.logout} eventKey=\"1\">Sign Out</NavDropdown.Item>\r\n                </NavDropdown>\r\n                <Navbar.Brand>\r\n                    <img id=\"listify-logo\" src={LOGO} alt=\"Logo\" height=\"30\" width=\"30\"/>\r\n                </Navbar.Brand>\r\n            </Nav>\r\n            </Nav>\r\n            <Tab.Content>\r\n                <Tab.Pane eventKey=\"search\">\r\n                    <SearchPresenter>\r\n                    </SearchPresenter> \r\n                </Tab.Pane>\r\n                <Tab.Pane eventKey=\"playlist\">\r\n                    <PlaylistPresenter>\r\n                    </PlaylistPresenter>\r\n                </Tab.Pane>\r\n                <Tab.Pane eventKey=\"tracks\">\r\n                    <TracksPresenter></TracksPresenter>\r\n                </Tab.Pane>\r\n            </Tab.Content>\r\n            </Tab.Container>\r\n        </div>\r\n  );\r\n}\r\n\r\nexport default AuthorizedView;\r\n\r\n","// src/presenters/AuthorizedPresenter.js\r\nimport { useEffect } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport AuthorizedView from '../views/AuthorizedView';\r\nimport { useHistory } from 'react-router';\r\nimport userActions from '../state/user/userActions';\r\nimport fbaseActions from '../state/fbase/fbaseActions';\r\nimport searchActions from '../state/search/searchActions';\r\nimport LoadingView from '../views/LoadingView';\r\n\r\nfunction AuthorizedPresenter(props){\r\n    const { token, user } = props;\r\n    const history = useHistory();\r\n    \r\n    // makes sure the user is authorized\r\n    if(!token){\r\n        history.push(\"/login\");\r\n    }\r\n\r\n    useEffect(() => {\r\n        if(token && !user.id){\r\n            props.fetchSpotifyUser(token);\r\n        }\r\n    }, [token]);\r\n\r\n    const onTabClick = () => props.setSearchTabVisibility(false);\r\n    const onSearchTabClick = () => props.setSearchTabVisibility(true);\r\n\r\n    return (user.id) ? <AuthorizedView username={user.display_name || user.id || \"\"}\r\n                        logout={() => props.logout()}\r\n                        onTabClick={onTabClick}\r\n                        onSearchTabClick={onSearchTabClick} />\r\n                        : \r\n                        <LoadingView size=\"lg\" />;\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n    token: state.auth.spotify.token,\r\n    user: state.user\r\n})\r\n  \r\nconst mapDispatchToProps = {\r\n    fetchSpotifyUser: userActions.fetchUser,\r\n    logout: fbaseActions.logout,\r\n    setSearchTabVisibility: searchActions.setIsTabVisible,\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AuthorizedPresenter);","// src/state/user/userActions.js\r\nimport { createAction } from '../utils';\r\nimport * as types from './userTypes';\r\n\r\nconst actions = {\r\n    initUser: () => createAction(types.USER_INIT),\r\n    fetchUser: (token) => createAction(types.USER_GET, {token} ),\r\n};\r\nexport default actions;","// src/state/fbase/fbaseActions.js\r\nimport { createAction } from '../utils';\r\nimport * as types from './fbaseTypes';\r\n\r\nconst actions = {\r\n    initFbase: () => createAction(types.FBASE_INIT),\r\n    authFbase: () => createAction(types.FBASE_AUTHENTICATE),\r\n    setUid: (uid) => createAction(types.FBASE_SET_UID, {uid}),\r\n    logout: () => createAction(types.FBASE_SIGN_OUT),\r\n};\r\nexport default actions;","// src/state/auth/authActions.js\r\nimport { createAction } from '../utils';\r\nimport * as types from './authTypes';\r\n\r\nconst actions = {\r\n    initAuth: () => createAction(types.AUTH_INIT_TEST),\r\n    saveSpotifyToken: (token, expires_in, spotify_string) => createAction(types.AUTH_SPOTIFY, {token, expires_in, spotify_string}),\r\n    saveSpotifyTokenError: (error) => createAction(types.AUTH_SPOTIFY_ERROR, {error}),\r\n    setSpotifyState: (spotify_string) => createAction(types.AUTH_SPOTIFY_SET_STATE, {spotify_string}),\r\n};\r\nexport default actions;","// src/presenters/LoginPresenter.js\r\nimport { connect } from 'react-redux';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\nimport authActions from '../state/auth/authActions';\r\nimport LoadingView from '../views/LoadingView';\r\n\r\nfunction LoginPresenter(props){\r\n    const history = useHistory();\r\n    const params = useParams();\r\n\r\n    // state must be present and correct\r\n    if(!params.state || params.state !== localStorage.getItem(\"spotifyState\")){\r\n        history.push(\"/login\");\r\n    }\r\n\r\n    \r\n    if(params.error){\r\n        props.saveSpotifyTokenError(params.error);\r\n        history.push(\"/login\");\r\n    }\r\n    \r\n    if(params.token && params.expires_in){\r\n        props.saveSpotifyToken(params.token, params.expires_in);\r\n        localStorage.removeItem(\"spotifyState\");\r\n    }\r\n\r\n    return <LoadingView size=\"lg\"/>;\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n    auth: state.auth\r\n})\r\n  \r\nconst mapDispatchToProps = {\r\n    // ... normally is an object full of action creators\r\n    saveSpotifyToken: authActions.saveSpotifyToken,\r\n    saveSpotifyTokenError: authActions.saveSpotifyTokenError\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(LoginPresenter);","// src/api/spotifyAuth.js\r\n\r\n// generates a random String used to validate that the request is actually from the user's browser\r\nfunction generateSpotifyString(len){\r\n    var arr = new Uint8Array((len || 10) / 2);\r\n    window.crypto.getRandomValues(arr);\r\n    return Array.from(arr, (dec)=>dec.toString(16).padStart(2, \"0\")).join('');\r\n}\r\n\r\n// Spotify's \"Implicit Grant Flow\", general info at:\r\n// https://developer.spotify.com/documentation/general/guides/authorization-guide/#implicit-grant-flow\r\nconst clientId = \"c0e19491232e4cadbff0efd339179f6d\";\r\nconst redirectUri = (process.env.NODE_ENV !== 'production') ? \"http://localhost:3000/#\" : \"https://martinfalke.github.io/spotify-project/#\"; //\"https://listify-app.github.io/#/login\";\r\n\r\n// https://developer.spotify.com/documentation/general/guides/scopes/#overview\r\n// encode spaces as %20 after reducing from array (done to easily add/remove scopes)\r\nconst scope = encodeURIComponent([\r\n    \"ugc-image-upload\",             // Upload cover image for playlists\r\n    \"playlist-modify-public\",       // Modify public playlists\r\n    \"playlist-modify-private\",      // Modify private playlists\r\n        //\"user-library-read\",            // View saved tracks, albums etc.\r\n        //\"user-library-modify\",          // Save/unsave tracks, albums etc.\r\n    \"playlist-read-private\",        // Get list of user's playlists\r\n    \"playlist-read-collaborative\",  // Include collaborative lists when getting user's playlists\r\n    \"user-read-private\",            // To only show search results available to the user's market\r\n].reduce( (total, d, i) => {\r\n    return (i !== 0) ? total + \" \" + d : d;\r\n}));\r\n\r\n// TODO: add \"show_dialog\" forced in development mode, to always prompt the developer for authorizing our app through Spotify\r\n\r\nconst authUrl = `https://accounts.spotify.com/authorize?client_id=${clientId}&redirect_uri=${encodeURIComponent(redirectUri)}&scope=${scope}&response_type=token`;\r\n\r\nexport { redirectUri, generateSpotifyString };\r\nexport default authUrl;","export default __webpack_public_path__ + \"static/media/Startpage.2c2beade.png\";","// src/views/StartView.js\r\nimport Button from 'react-bootstrap/Button';\r\nimport Startintro from '../images/Startpage.png'\r\nimport \"./StartView.scss\";\r\n\r\nfunction StartView(props){\r\n    return(\r\n        <div className=\"start-view\" >\r\n          <img src={Startintro} alt=\"Listify logo\"></img>\r\n\r\n\r\n          <div className=\"login-btn-wrapper\">\r\n            <Button variant=\"info\" href={props.loginUrl} className=\"login-btn\">\r\n            <i className=\"fa fa-lg fa-spotify\">\r\n              Login with Spotify\r\n              </i>\r\n            </Button>\r\n            {/* <h3 id=\"intro-header\">Listify enables Spotify users to customize their playlists in a creative way</h3>\r\n            <p id=\"intro\">\r\n            Listify is divided into 3 unique sections to offer all the tools you need to customize your playlist. \r\n            The first section is called \"Playlist\" and this is where you can customize your existing playlists by removing songs, switching places, add to your track stash or to search for a specific song/artist/album.\r\n            The second section is called \"Search\" and here is where you search for new songs and add them into your stash of tracks and once you are done you can view your selected songs under \"Tracks\" \r\n            </p> */}\r\n          </div>\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport default StartView; ","// src/presenters/StartPresenter.js\r\nimport { useEffect, useState } from 'react';\r\nimport spotifyAuthUrl, { generateSpotifyString } from '../api/spotifyAuth';\r\nimport StartView from '../views/StartView';\r\n\r\nimport { connect } from 'react-redux';\r\nimport authActions from '../state/auth/authActions';\r\nimport { useHistory } from 'react-router';\r\n\r\nfunction StartPresenter(props){\r\n    const { token } = props;\r\n    const history = useHistory();\r\n    const [spotifyString, setSpotifyString] = useState(null);\r\n\r\n    useEffect(function(){\r\n        const randomString = generateSpotifyString();\r\n        setSpotifyString(randomString);\r\n        props.setSpotifyState(randomString);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if(token){\r\n            // user is already authorized, redirect to AuthorizedPresenter/View\r\n            history.push(\"/\");\r\n        }\r\n    }, [token]);\r\n\r\n    return <StartView loginUrl={`${spotifyAuthUrl}&state=${spotifyString}`} />;\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n    token: state.auth.spotify.token,\r\n});\r\n\r\nconst mapDispatchToProps = {\r\n    setSpotifyState: authActions.setSpotifyState,\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(StartPresenter);","import './App.scss';\nimport React, { useEffect } from 'react';\nimport { Switch, Redirect, Route } from 'react-router';\nimport AuthorizedPresenter from './presenters/AuthorizedPresenter';\nimport LoginPresenter from './presenters/LoginPresenter';\nimport StartPresenter from './presenters/StartPresenter';\nimport { connect } from 'react-redux';\nimport authActions from './state/auth/authActions';\nimport { isDateExpired } from './state/utils';\nimport LoadingView from './views/LoadingView';\n\nfunction App(props) {\n  \n  const {uid} = props;\n  \n  useEffect(()=>{\n    let storedToken = localStorage.getItem(\"spotifyToken\");\n    let tokenExpiration = localStorage.getItem(\"spotifyExpiration\");\n    if (storedToken && tokenExpiration) {\n      if (isDateExpired(new Date(Date.parse(tokenExpiration)))) {\n        // stored token is expired, redirect to login page\n        localStorage.removeItem(\"spotifyToken\");\n        localStorage.removeItem(\"spotifyExpiration\");\n        sessionStorage.clear();\n      }else{\n        props.saveSpotifyToken(storedToken);\n      }\n    }\n  }, []);\n\n\n  return (\n    (!uid) ? <LoadingView size=\"lg\" />\n    :\n    <Switch>\n      <Route path=\"/access_token=:token(.*)&token_type=Bearer&expires_in=:expires_in(.*)&state=:state(.*)\" component={LoginPresenter} />\n      <Route path=\"/error=:error(.*)&state=:state(.*)\" component={LoginPresenter} />\n      <Route exact path=\"/login\" component={StartPresenter} />\n      <Route exact path=\"/\" component={AuthorizedPresenter} />\n      <Route path=\"/*\" render={()=>{return <Redirect to=\"/\" />;}} />\n    </Switch>\n  );\n}\n\nconst mapStateToProps = (state) => ({\n  token: state.auth.spotify.token,\n  uid: state.fbase.uid\n})\n\nconst mapDispatchToProps = {\n  saveSpotifyToken: authActions.saveSpotifyToken,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","// src/index.js\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { Provider } from 'react-redux';\nimport store from './state/store';\n\nimport { HashRouter } from 'react-router-dom';\n\nimport './index.scss';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <HashRouter hashType=\"noslash\">\n        <App />\n      </HashRouter> \n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}